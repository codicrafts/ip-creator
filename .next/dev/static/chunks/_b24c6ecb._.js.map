{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/weili/work/generate-web/services/paymentService.ts"],"sourcesContent":["import { PaymentMethod, CreateOrderRequest, CreateOrderResponse, PaymentOrder } from '../types';\n\n// ÈÖçÁΩÆÔºöÂêéÁ´Ø API Âú∞ÂùÄ\n// ËØ∑Ê†πÊçÆÂÆûÈôÖÊÉÖÂÜµ‰øÆÊîπ‰∏∫‰Ω†ÁöÑÂêéÁ´Ø API Âú∞ÂùÄ\n// Next.js ÁéØÂ¢ÉÂèòÈáèÈúÄË¶Å‰ª• NEXT_PUBLIC_ ÂºÄÂ§¥ÊâçËÉΩÂú®ÂÆ¢Êà∑Á´ØËÆøÈóÆ\nconst PAYMENT_API_BASE_URL = process.env.NEXT_PUBLIC_PAYMENT_API_URL || 'https://your-api-domain.com/api/payment';\n\n/**\n * ÂàõÂª∫ÊîØ‰ªòËÆ¢Âçï\n * @param request ËÆ¢ÂçïËØ∑Ê±ÇÂèÇÊï∞\n * @returns ÊîØ‰ªòÂèÇÊï∞ÔºàÁî®‰∫éË∞ÉËµ∑ÊîØ‰ªòÔºâ\n */\nexport const createPaymentOrder = async (\n  request: CreateOrderRequest\n): Promise<CreateOrderResponse> => {\n  try {\n    const response = await fetch(`${PAYMENT_API_BASE_URL}/create`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(request),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.message || 'ÂàõÂª∫ËÆ¢ÂçïÂ§±Ë¥•');\n    }\n\n    const data = await response.json();\n    return data;\n  } catch (error) {\n    console.error('Create payment order error:', error);\n    throw error;\n  }\n};\n\n/**\n * Êü•ËØ¢ËÆ¢ÂçïÁä∂ÊÄÅ\n * @param orderId ËÆ¢ÂçïID\n * @returns ËÆ¢Âçï‰ø°ÊÅØ\n */\nexport const queryOrderStatus = async (orderId: string): Promise<PaymentOrder> => {\n  try {\n    const response = await fetch(`${PAYMENT_API_BASE_URL}/query/${orderId}`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error('Êü•ËØ¢ËÆ¢ÂçïÂ§±Ë¥•');\n    }\n\n    const data = await response.json();\n    return data;\n  } catch (error) {\n    console.error('Query order status error:', error);\n    throw error;\n  }\n};\n\n/**\n * Ë∞ÉËµ∑ÂæÆ‰ø°ÊîØ‰ªò\n * @param params ÂæÆ‰ø°ÊîØ‰ªòÂèÇÊï∞\n * @returns Promise<void>\n */\nexport const launchWechatPay = (params: {\n  appId: string;\n  timeStamp: string;\n  nonceStr: string;\n  package: string;\n  signType: string;\n  paySign: string;\n}): Promise<void> => {\n  return new Promise((resolve, reject) => {\n    // Ê£ÄÊü•ÊòØÂê¶Âú®ÂæÆ‰ø°ÁéØÂ¢É\n    if (typeof window === 'undefined' || !(window as any).WeixinJSBridge) {\n      // Â¶ÇÊûú‰∏çÂú®ÂæÆ‰ø°ÁéØÂ¢ÉÔºåÂ∞ùËØï‰ΩøÁî® JSSDK\n      if ((window as any).wx) {\n        // ‰ΩøÁî®ÂæÆ‰ø° JSSDK Ë∞ÉËµ∑ÊîØ‰ªò\n        (window as any).wx.chooseWXPay({\n          timestamp: params.timeStamp,\n          nonceStr: params.nonceStr,\n          package: params.package,\n          signType: params.signType,\n          paySign: params.paySign,\n          success: () => {\n            resolve();\n          },\n          fail: (err: any) => {\n            reject(new Error(err.errMsg || 'ÊîØ‰ªòÂ§±Ë¥•'));\n          },\n        });\n      } else {\n        reject(new Error('ËØ∑Âú®ÂæÆ‰ø°‰∏≠ÊâìÂºÄ'));\n      }\n      return;\n    }\n\n    // ‰ΩøÁî® WeixinJSBridge Ë∞ÉËµ∑ÊîØ‰ªò\n    (window as any).WeixinJSBridge.invoke(\n      'getBrandWCPayRequest',\n      {\n        appId: params.appId,\n        timeStamp: params.timeStamp,\n        nonceStr: params.nonceStr,\n        package: params.package,\n        signType: params.signType,\n        paySign: params.paySign,\n      },\n      (res: any) => {\n        if (res.err_msg === 'get_brand_wcpay_request:ok') {\n          resolve();\n        } else {\n          reject(new Error(res.err_msg || 'ÊîØ‰ªòÂ§±Ë¥•'));\n        }\n      }\n    );\n  });\n};\n\n/**\n * Ë∞ÉËµ∑ÊîØ‰ªòÂÆùÊîØ‰ªò\n * @param orderString ÊîØ‰ªòÂÆùËÆ¢ÂçïÂ≠óÁ¨¶‰∏≤\n * @returns Promise<void>\n */\nexport const launchAlipay = (orderString: string): Promise<void> => {\n  return new Promise((resolve, reject) => {\n    // ÂàõÂª∫ÈöêËóèÁöÑË°®ÂçïÂπ∂Êèê‰∫§\n    const form = document.createElement('form');\n    form.method = 'POST';\n    form.action = 'https://openapi.alipay.com/gateway.do';\n    form.style.display = 'none';\n\n    // Ëß£Êûê orderString Âπ∂ÂàõÂª∫Ë°®ÂçïÂ≠óÊÆµ\n    // orderString Ê†ºÂºèÈÄöÂ∏∏ÊòØÔºöapp_id=xxx&biz_content=xxx&charset=xxx&...\n    const params = new URLSearchParams(orderString);\n    params.forEach((value, key) => {\n      const input = document.createElement('input');\n      input.type = 'hidden';\n      input.name = key;\n      input.value = value;\n      form.appendChild(input);\n    });\n\n    document.body.appendChild(form);\n    form.submit();\n\n    // Ê≥®ÊÑèÔºöÊîØ‰ªòÂÆùÊîØ‰ªòÂêé‰ºöÂú®Êñ∞Á™óÂè£ÊâìÂºÄÔºåÊó†Ê≥ïÁõ¥Êé•ÁõëÂê¨ÁªìÊûú\n    // ÈúÄË¶ÅÈÄöËøáËΩÆËØ¢ËÆ¢ÂçïÁä∂ÊÄÅÊù•Á°ÆËÆ§ÊîØ‰ªòÁªìÊûú\n    resolve();\n  });\n};\n\n/**\n * ËΩÆËØ¢ËÆ¢ÂçïÁä∂ÊÄÅÁõ¥Âà∞ÊîØ‰ªòÂÆåÊàêÊàñË∂ÖÊó∂\n * @param orderId ËÆ¢ÂçïID\n * @param maxAttempts ÊúÄÂ§ßÂ∞ùËØïÊ¨°Êï∞\n * @param interval ËΩÆËØ¢Èó¥ÈöîÔºàÊØ´ÁßíÔºâ\n * @returns ËÆ¢ÂçïÁä∂ÊÄÅ\n */\nexport const pollOrderStatus = async (\n  orderId: string,\n  maxAttempts = 30,\n  interval = 2000\n): Promise<PaymentOrder> => {\n  for (let i = 0; i < maxAttempts; i++) {\n    try {\n      const order = await queryOrderStatus(orderId);\n      if (order.status === 'SUCCESS' || order.status === 'FAILED' || order.status === 'CANCELLED') {\n        return order;\n      }\n      // Á≠âÂæÖÂêéÁªßÁª≠ËΩÆËØ¢\n      await new Promise((resolve) => setTimeout(resolve, interval));\n    } catch (error) {\n      console.error(`Poll attempt ${i + 1} failed:`, error);\n      if (i === maxAttempts - 1) {\n        throw error;\n      }\n      await new Promise((resolve) => setTimeout(resolve, interval));\n    }\n  }\n  throw new Error('ÊîØ‰ªòË∂ÖÊó∂ÔºåËØ∑Á®çÂêéÊü•ËØ¢ËÆ¢ÂçïÁä∂ÊÄÅ');\n};\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 151, "column": 0}, "map": {"version":3,"sources":["file:///Users/weili/work/generate-web/components/PaymentModal.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState } from 'react';\nimport { X, CreditCard, Smartphone, Loader2, CheckCircle, XCircle } from 'lucide-react';\nimport { PaymentMethod, CreateOrderRequest } from '@/types';\nimport { createPaymentOrder, launchWechatPay, launchAlipay, pollOrderStatus } from '@/services/paymentService';\n\ninterface PaymentModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess: () => void;\n  amount: number; // ÈáëÈ¢ùÔºàÂÖÉÔºâ\n  productName: string;\n  productDesc?: string;\n}\n\nconst PaymentModal: React.FC<PaymentModalProps> = ({\n  isOpen,\n  onClose,\n  onSuccess,\n  amount,\n  productName,\n  productDesc,\n}) => {\n  const [selectedMethod, setSelectedMethod] = useState<PaymentMethod | null>(null);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [paymentStatus, setPaymentStatus] = useState<'idle' | 'processing' | 'success' | 'failed'>('idle');\n\n  if (!isOpen) return null;\n\n  const handlePayment = async () => {\n    if (!selectedMethod) {\n      setError('ËØ∑ÈÄâÊã©ÊîØ‰ªòÊñπÂºè');\n      return;\n    }\n\n    setIsProcessing(true);\n    setError(null);\n    setPaymentStatus('processing');\n\n    try {\n      // 1. ÂàõÂª∫ËÆ¢Âçï\n      const request: CreateOrderRequest = {\n        amount: Math.round(amount * 100), // ËΩ¨Êç¢‰∏∫ÂàÜ\n        productName,\n        productDesc,\n        paymentMethod: selectedMethod,\n        userId: localStorage.getItem('userId') || undefined, // Â¶ÇÊûúÊúâÁî®Êà∑ID\n      };\n\n      const orderResponse = await createPaymentOrder(request);\n      const { orderId, paymentParams } = orderResponse;\n\n      // 2. Ë∞ÉËµ∑ÊîØ‰ªò\n      if (selectedMethod === PaymentMethod.WECHAT) {\n        await launchWechatPay(paymentParams as any);\n      } else if (selectedMethod === PaymentMethod.ALIPAY) {\n        await launchAlipay((paymentParams as any).orderString);\n      }\n\n      // 3. ËΩÆËØ¢ËÆ¢ÂçïÁä∂ÊÄÅ\n      const order = await pollOrderStatus(orderId);\n\n      if (order.status === 'SUCCESS') {\n        setPaymentStatus('success');\n        setTimeout(() => {\n          onSuccess();\n          handleClose();\n        }, 1500);\n      } else {\n        setPaymentStatus('failed');\n        setError('ÊîØ‰ªòÂ§±Ë¥•ÔºåËØ∑ÈáçËØï');\n      }\n    } catch (err: any) {\n      console.error('Payment error:', err);\n      setPaymentStatus('failed');\n      setError(err.message || 'ÊîØ‰ªòÂ§±Ë¥•ÔºåËØ∑ÈáçËØï');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleClose = () => {\n    if (!isProcessing) {\n      setSelectedMethod(null);\n      setError(null);\n      setPaymentStatus('idle');\n      onClose();\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in duration-200 p-4\">\n      <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-md md:max-w-lg mx-4 overflow-hidden animate-in zoom-in-95 duration-200\">\n        {/* Header */}\n        <div className=\"relative bg-gradient-to-r from-violet-600 to-violet-700 p-6 text-white\">\n          <button\n            onClick={handleClose}\n            disabled={isProcessing}\n            className=\"absolute top-4 right-4 p-2 hover:bg-white/20 rounded-full transition-colors disabled:opacity-50\"\n          >\n            <X size={20} />\n          </button>\n          <h2 className=\"text-2xl font-bold\">ÂçáÁ∫ß‰ºöÂëò</h2>\n          <p className=\"text-violet-100 text-sm mt-1\">{productDesc || 'Ëß£ÈîÅÊõ¥Â§öÂäüËÉΩ'}</p>\n        </div>\n\n        {/* Content */}\n        <div className=\"p-6 space-y-6\">\n          {/* Amount Display */}\n          <div className=\"text-center py-4 bg-gray-50 rounded-2xl\">\n            <div className=\"text-sm text-gray-500 mb-1\">ÊîØ‰ªòÈáëÈ¢ù</div>\n            <div className=\"text-4xl font-bold text-gray-900\">\n              ¬•<span>{amount.toFixed(2)}</span>\n            </div>\n          </div>\n\n          {/* Payment Methods */}\n          {paymentStatus === 'idle' && (\n            <div className=\"space-y-3\">\n              <div className=\"text-sm font-semibold text-gray-700 mb-2\">ÈÄâÊã©ÊîØ‰ªòÊñπÂºè</div>\n              \n              <button\n                onClick={() => setSelectedMethod(PaymentMethod.WECHAT)}\n                disabled={isProcessing}\n                className={`w-full p-4 rounded-xl border-2 transition-all flex items-center gap-4 ${\n                  selectedMethod === PaymentMethod.WECHAT\n                    ? 'border-violet-500 bg-violet-50'\n                    : 'border-gray-200 hover:border-violet-200'\n                } ${isProcessing ? 'opacity-50 cursor-not-allowed' : ''}`}\n              >\n                <div className={`w-12 h-12 rounded-lg flex items-center justify-center ${\n                  selectedMethod === PaymentMethod.WECHAT ? 'bg-violet-100' : 'bg-gray-100'\n                }`}>\n                  <Smartphone size={24} className={selectedMethod === PaymentMethod.WECHAT ? 'text-violet-600' : 'text-gray-600'} />\n                </div>\n                <div className=\"flex-1 text-left\">\n                  <div className=\"font-semibold text-gray-900\">ÂæÆ‰ø°ÊîØ‰ªò</div>\n                  <div className=\"text-xs text-gray-500\">Êé®Ëçê‰ΩøÁî®</div>\n                </div>\n                {selectedMethod === PaymentMethod.WECHAT && (\n                  <div className=\"w-5 h-5 rounded-full bg-violet-600 flex items-center justify-center\">\n                    <div className=\"w-2 h-2 rounded-full bg-white\"></div>\n                  </div>\n                )}\n              </button>\n\n              <button\n                onClick={() => setSelectedMethod(PaymentMethod.ALIPAY)}\n                disabled={isProcessing}\n                className={`w-full p-4 rounded-xl border-2 transition-all flex items-center gap-4 ${\n                  selectedMethod === PaymentMethod.ALIPAY\n                    ? 'border-violet-500 bg-violet-50'\n                    : 'border-gray-200 hover:border-violet-200'\n                } ${isProcessing ? 'opacity-50 cursor-not-allowed' : ''}`}\n              >\n                <div className={`w-12 h-12 rounded-lg flex items-center justify-center ${\n                  selectedMethod === PaymentMethod.ALIPAY ? 'bg-violet-100' : 'bg-gray-100'\n                }`}>\n                  <CreditCard size={24} className={selectedMethod === PaymentMethod.ALIPAY ? 'text-violet-600' : 'text-gray-600'} />\n                </div>\n                <div className=\"flex-1 text-left\">\n                  <div className=\"font-semibold text-gray-900\">ÊîØ‰ªòÂÆù</div>\n                  <div className=\"text-xs text-gray-500\">ÂÆâÂÖ®‰æøÊç∑</div>\n                </div>\n                {selectedMethod === PaymentMethod.ALIPAY && (\n                  <div className=\"w-5 h-5 rounded-full bg-violet-600 flex items-center justify-center\">\n                    <div className=\"w-2 h-2 rounded-full bg-white\"></div>\n                  </div>\n                )}\n              </button>\n            </div>\n          )}\n\n          {/* Processing Status */}\n          {paymentStatus === 'processing' && (\n            <div className=\"flex flex-col items-center justify-center py-8 space-y-4\">\n              <Loader2 className=\"w-12 h-12 text-violet-600 animate-spin\" />\n              <div className=\"text-center\">\n                <div className=\"font-semibold text-gray-900\">Ê≠£Âú®Â§ÑÁêÜÊîØ‰ªò...</div>\n                <div className=\"text-sm text-gray-500 mt-1\">ËØ∑ÂÆåÊàêÊîØ‰ªòÊìç‰Ωú</div>\n              </div>\n            </div>\n          )}\n\n          {/* Success Status */}\n          {paymentStatus === 'success' && (\n            <div className=\"flex flex-col items-center justify-center py-8 space-y-4\">\n              <CheckCircle className=\"w-16 h-16 text-green-500\" />\n              <div className=\"text-center\">\n                <div className=\"font-semibold text-gray-900 text-lg\">ÊîØ‰ªòÊàêÂäüÔºÅ</div>\n                <div className=\"text-sm text-gray-500 mt-1\">Ê≠£Âú®‰∏∫ÊÇ®ÂçáÁ∫ß‰ºöÂëò...</div>\n              </div>\n            </div>\n          )}\n\n          {/* Failed Status */}\n          {paymentStatus === 'failed' && (\n            <div className=\"flex flex-col items-center justify-center py-8 space-y-4\">\n              <XCircle className=\"w-16 h-16 text-red-500\" />\n              <div className=\"text-center\">\n                <div className=\"font-semibold text-gray-900 text-lg\">ÊîØ‰ªòÂ§±Ë¥•</div>\n                <div className=\"text-sm text-gray-500 mt-1\">{error || 'ËØ∑ÈáçËØï'}</div>\n              </div>\n            </div>\n          )}\n\n          {/* Error Message */}\n          {error && paymentStatus === 'idle' && (\n            <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl text-sm\">\n              {error}\n            </div>\n          )}\n\n          {/* Action Buttons */}\n          {paymentStatus === 'idle' && (\n            <button\n              onClick={handlePayment}\n              disabled={!selectedMethod || isProcessing}\n              className={`w-full py-4 rounded-xl font-semibold text-white transition-all flex items-center justify-center gap-2 ${\n                !selectedMethod || isProcessing\n                  ? 'bg-gray-300 cursor-not-allowed'\n                  : 'bg-violet-600 hover:bg-violet-700 active:scale-95'\n              }`}\n            >\n              {isProcessing ? (\n                <>\n                  <Loader2 className=\"animate-spin\" size={18} />\n                  Â§ÑÁêÜ‰∏≠...\n                </>\n              ) : (\n                <>\n                  <CreditCard size={18} />\n                  Á°ÆËÆ§ÊîØ‰ªò ¬•{amount.toFixed(2)}\n                </>\n              )}\n            </button>\n          )}\n\n          {paymentStatus === 'failed' && (\n            <div className=\"flex gap-3\">\n              <button\n                onClick={handleClose}\n                className=\"flex-1 py-3 rounded-xl font-semibold border-2 border-gray-200 text-gray-700 hover:bg-gray-50\"\n              >\n                ÂèñÊ∂à\n              </button>\n              <button\n                onClick={() => {\n                  setPaymentStatus('idle');\n                  setError(null);\n                }}\n                className=\"flex-1 py-3 rounded-xl font-semibold bg-violet-600 text-white hover:bg-violet-700\"\n              >\n                ÈáçËØï\n              </button>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default PaymentModal;\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 687, "column": 0}, "map": {"version":3,"sources":["file:///Users/weili/work/generate-web/services/geminiService.ts"],"sourcesContent":["// Nano Banana API endpoint\nconst API_BASE_URL =\n  \"https://api.laozhang.ai/v1beta/models/gemini-2.5-flash-image:generateContent\";\nconst API_KEY = process.env.API_KEY || process.env.GEMINI_API_KEY;\n\n/**\n * Resize image if it exceeds max dimensions to prevent API errors.\n */\nconst resizeImage = async (\n  base64Str: string,\n  maxWidth = 1024,\n  maxHeight = 1024\n): Promise<string> => {\n  return new Promise((resolve) => {\n    const img = new Image();\n    img.src = base64Str;\n    img.onload = () => {\n      let width = img.width;\n      let height = img.height;\n\n      if (width <= maxWidth && height <= maxHeight) {\n        resolve(base64Str);\n        return;\n      }\n\n      if (width > height) {\n        if (width > maxWidth) {\n          height = Math.round((height *= maxWidth / width));\n          width = maxWidth;\n        }\n      } else {\n        if (height > maxHeight) {\n          width = Math.round((width *= maxHeight / height));\n          height = maxHeight;\n        }\n      }\n\n      const canvas = document.createElement(\"canvas\");\n      canvas.width = width;\n      canvas.height = height;\n      const ctx = canvas.getContext(\"2d\");\n      ctx?.drawImage(img, 0, 0, width, height);\n      resolve(canvas.toDataURL(\"image/jpeg\", 0.9)); // Use JPEG 0.9 for reasonable quality/size\n    };\n    img.onerror = () => resolve(base64Str); // Fallback\n  });\n};\n\n/**\n * Generates a new image based on an input image and a text prompt using Gemini 2.5 Flash Image.\n */\nexport const generateExtendedScene = async (\n  base64Image: string,\n  mimeType: string,\n  prompt: string,\n  aspectRatio?: string,\n  imageSize?: \"1K\" | \"2K\" | \"4K\",\n  imageFormat?: \"PNG\" | \"JPEG\" | \"WEBP\"\n): Promise<string> => {\n  try {\n    if (!API_KEY) {\n      throw new Error(\"API_KEY is not set\");\n    }\n\n    // Optimize image size before sending\n    const optimizedImage = await resizeImage(base64Image);\n    const cleanBase64 = optimizedImage.replace(\n      /^data:image\\/(png|jpeg|webp);base64,/,\n      \"\"\n    );\n\n    const generationConfig: any = {\n      responseModalities: [\"IMAGE\"],\n    };\n\n    // Add imageConfig if aspectRatio, imageSize, or imageFormat is provided\n    if (aspectRatio || imageSize || imageFormat) {\n      generationConfig.imageConfig = {};\n      if (aspectRatio) {\n        generationConfig.imageConfig.aspectRatio = aspectRatio;\n      }\n      if (imageSize) {\n        generationConfig.imageConfig.imageSize = imageSize;\n      }\n      if (imageFormat) {\n        generationConfig.imageConfig.outputFormat = imageFormat;\n      }\n    }\n\n    const requestBody = {\n      contents: [\n        {\n          parts: [\n            {\n              inlineData: {\n                data: cleanBase64,\n                mimeType: \"image/jpeg\", // optimized is always jpeg/png\n              },\n            },\n            {\n              text: prompt,\n            },\n          ],\n        },\n      ],\n      generationConfig,\n    };\n\n    const response = await fetch(API_BASE_URL, {\n      method: \"POST\",\n      headers: {\n        Authorization: `Bearer ${API_KEY}`,\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify(requestBody),\n    });\n\n    if (!response.ok) {\n      const errorText = await response.text();\n      throw new Error(\n        `API request failed: ${response.status} ${response.statusText} - ${errorText}`\n      );\n    }\n\n    const data = await response.json();\n    const parts = data.candidates?.[0]?.content?.parts;\n    if (!parts) {\n      throw new Error(\"No content generated\");\n    }\n\n    for (const part of parts) {\n      if (part.inlineData && part.inlineData.data) {\n        const outputMimeType = part.inlineData.mimeType || \"image/png\";\n        return `data:${outputMimeType};base64,${part.inlineData.data}`;\n      }\n    }\n\n    throw new Error(\"No image data found in the response\");\n  } catch (error) {\n    console.error(\"Gemini API Error:\", error);\n    throw error;\n  }\n};\n\n/**\n * Generates a meme/sticker version of the input image.\n */\nexport const generateSticker = async (\n  base64Image: string,\n  moodPrompt: string\n): Promise<string> => {\n  try {\n    if (!API_KEY) {\n      throw new Error(\"API_KEY is not set\");\n    }\n\n    // Optimize image size before sending\n    const optimizedImage = await resizeImage(base64Image);\n    const cleanBase64 = optimizedImage.replace(\n      /^data:image\\/(png|jpeg|webp);base64,/,\n      \"\"\n    );\n\n    const fullPrompt = `Turn the main character in this image into a high-quality die-cut sticker. \n    Style: Vector art, flat color, thick white outline, white background. \n    Expression/Action: ${moodPrompt}. \n    Ensure the character is isolated on a pure white background. \n    Do not add text inside the image.`;\n\n    const requestBody = {\n      contents: [\n        {\n          parts: [\n            {\n              inlineData: {\n                data: cleanBase64,\n                mimeType: \"image/jpeg\",\n              },\n            },\n            {\n              text: fullPrompt,\n            },\n          ],\n        },\n      ],\n      generationConfig: {\n        responseModalities: [\"IMAGE\"],\n      },\n    };\n\n    const response = await fetch(API_BASE_URL, {\n      method: \"POST\",\n      headers: {\n        Authorization: `Bearer ${API_KEY}`,\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify(requestBody),\n    });\n\n    if (!response.ok) {\n      const errorText = await response.text();\n      throw new Error(\n        `API request failed: ${response.status} ${response.statusText} - ${errorText}`\n      );\n    }\n\n    const data = await response.json();\n    const parts = data.candidates?.[0]?.content?.parts;\n    if (!parts) throw new Error(\"No content generated\");\n\n    for (const part of parts) {\n      if (part.inlineData && part.inlineData.data) {\n        const outputMimeType = part.inlineData.mimeType || \"image/png\";\n        return `data:${outputMimeType};base64,${part.inlineData.data}`;\n      }\n    }\n    throw new Error(\"No image data found\");\n  } catch (error) {\n    console.error(\"Sticker Generation Error:\", error);\n    throw error;\n  }\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 873, "column": 0}, "map": {"version":3,"sources":["file:///Users/weili/work/generate-web/lib/constants.tsx"],"sourcesContent":["'use client';\n\nimport { Square, Activity, RefreshCcw } from 'lucide-react';\nimport { AnimationType } from '@/types';\n\nexport const PRESET_STYLES = [\n  {\n    id: 'realistic',\n    label: 'ÂÜôÂÆûÊëÑÂΩ±',\n    value:\n      'photorealistic, 8k, highly detailed, cinematic lighting, realistic textures',\n  },\n  {\n    id: 'anime',\n    label: 'Êó•Á≥ªÂä®Êº´',\n    value:\n      'anime style, studio ghibli, vibrant colors, cel shading, detailed background',\n  },\n  {\n    id: 'watercolor',\n    label: 'Ê∏ÖÊñ∞Ê∞¥ÂΩ©',\n    value: 'watercolor painting, soft edges, artistic, pastel colors, dreamy atmosphere',\n  },\n  {\n    id: 'cyberpunk',\n    label: 'ËµõÂçöÊúãÂÖã',\n    value: 'cyberpunk, neon lights, futuristic city, high contrast, tech noir',\n  },\n  {\n    id: '3d',\n    label: '3D Ê∏≤Êüì',\n    value:\n      '3D render, blender, unreal engine 5, c4d, clay material, soft lighting',\n  },\n  {\n    id: 'illustration',\n    label: 'ÊâÅÂπ≥ÊèíÁîª',\n    value: 'flat illustration, vector art, minimal, clean lines, bold colors',\n  },\n  {\n    id: 'oil',\n    label: 'Ê≤πÁîªÈ£éÊ†º',\n    value:\n      'oil painting, textured brushstrokes, classical art style, van gogh style',\n  },\n  {\n    id: 'pixel',\n    label: 'ÂÉèÁ¥†Ëâ∫ÊúØ',\n    value: 'pixel art, 8-bit, retro game style, blocky',\n  },\n];\n\nexport const MOOD_PACKS = [\n  { id: 'custom', label: 'Ëá™ÂÆö‰πâ', items: [] },\n  {\n    id: 'worker',\n    label: 'ÊâìÂ∑•‰∫∫',\n    items: [\n      { text: 'Êî∂Âà∞', prompt: 'Êï¨Á§ºÔºåÁúºÁ•ûÂùöÂÆöÔºåÊà¥ÁùÄÈ¢ÜÂ∏¶ÔºåËÅå‰∏öÊÑü' },\n      { text: '‰∏ãÁè≠', prompt: 'È£ûÂø´Âú∞ÈÄÉË∑ëÔºåÂºÄÂøÉÔºåÊ®°Á≥äÁöÑËÉåÊôØ' },\n      { text: 'Â§™Èöæ‰∫Ü', prompt: 'Ë∫∫Âú®Âú∞‰∏äÔºåÁ≤æÁñ≤ÂäõÂ∞ΩÔºåÊµÅÁùÄÂ§∏Âº†ÁöÑÁúºÊ≥™' },\n      { text: 'Êë∏È±º', prompt: 'ÂñùÁùÄÂíñÂï°ÔºåÊà¥ÁùÄÂ¢®ÈïúÔºåÊÇ†Èó≤ÊîæÊùæ' },\n    ],\n  },\n  {\n    id: 'daily',\n    label: 'Êó•Â∏∏',\n    items: [\n      { text: 'Êó©‰∏äÂ•Ω', prompt: 'Êå•ÊâãÔºåÂºÄÂøÉÂ§ßÁ¨ëÔºåÈò≥ÂÖâËÉåÊôØ' },\n      { text: 'ÊôöÂÆâ', prompt: 'Áù°ËßâÔºåÊà¥ÁùÄÁù°Â∏ΩÔºåÂÆâËØ¶' },\n      { text: 'Ë∞¢Ë∞¢', prompt: 'Èû†Ë∫¨ÔºåÂèåÊâãÊØîÂøÉÔºåÊÑüÊøÄ' },\n      { text: 'Ôºü', prompt: 'Âõ∞ÊÉëÁöÑË°®ÊÉÖÔºåÊª°Â§¥ÈóÆÂè∑' },\n    ],\n  },\n];\n\nexport const ANIMATION_OPTIONS = [\n  { id: AnimationType.NONE, label: 'ÈùôÊÄÅ', icon: <Square size={14} /> },\n  { id: AnimationType.SHAKE, label: 'È¢§Êäñ', icon: <Activity size={14} /> },\n  {\n    id: AnimationType.PULSE,\n    label: 'ËÑâÂÜ≤',\n    icon: <div className=\"w-3 h-3 rounded-full border-2 border-current\"></div>,\n  },\n  {\n    id: AnimationType.ZOOM,\n    label: 'ÊîæÂ§ß',\n    icon: <div className=\"text-xs\">üîç</div>,\n  },\n  { id: AnimationType.SPIN, label: 'ÊóãËΩ¨', icon: <RefreshCcw size={14} /> },\n];\n\nexport const STORAGE_KEY = 'ip_creative_history_v1';\nexport const USER_TIER_KEY = 'ip_creative_user_tier';\nexport const DAILY_USAGE_KEY = 'ip_creative_daily_usage';\nexport const MAX_HISTORY_ITEMS = 10;\nexport const FREE_DAILY_LIMIT = 5;\nexport const PREMIUM_DAILY_LIMIT = 50;\n\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAEA;AAAA;AAAA;AACA;AAHA;;;;AAKO,MAAM,gBAAgB;IAC3B;QACE,IAAI;QACJ,OAAO;QACP,OACE;IACJ;IACA;QACE,IAAI;QACJ,OAAO;QACP,OACE;IACJ;IACA;QACE,IAAI;QACJ,OAAO;QACP,OAAO;IACT;IACA;QACE,IAAI;QACJ,OAAO;QACP,OAAO;IACT;IACA;QACE,IAAI;QACJ,OAAO;QACP,OACE;IACJ;IACA;QACE,IAAI;QACJ,OAAO;QACP,OAAO;IACT;IACA;QACE,IAAI;QACJ,OAAO;QACP,OACE;IACJ;IACA;QACE,IAAI;QACJ,OAAO;QACP,OAAO;IACT;CACD;AAEM,MAAM,aAAa;IACxB;QAAE,IAAI;QAAU,OAAO;QAAO,OAAO,EAAE;IAAC;IACxC;QACE,IAAI;QACJ,OAAO;QACP,OAAO;YACL;gBAAE,MAAM;gBAAM,QAAQ;YAAmB;YACzC;gBAAE,MAAM;gBAAM,QAAQ;YAAiB;YACvC;gBAAE,MAAM;gBAAO,QAAQ;YAAoB;YAC3C;gBAAE,MAAM;gBAAM,QAAQ;YAAiB;SACxC;IACH;IACA;QACE,IAAI;QACJ,OAAO;QACP,OAAO;YACL;gBAAE,MAAM;gBAAO,QAAQ;YAAe;YACtC;gBAAE,MAAM;gBAAM,QAAQ;YAAa;YACnC;gBAAE,MAAM;gBAAM,QAAQ;YAAa;YACnC;gBAAE,MAAM;gBAAK,QAAQ;YAAa;SACnC;IACH;CACD;AAEM,MAAM,oBAAoB;IAC/B;QAAE,IAAI,yHAAa,CAAC,IAAI;QAAE,OAAO;QAAM,oBAAM,8VAAC,uSAAM;YAAC,MAAM;;;;;;IAAO;IAClE;QAAE,IAAI,yHAAa,CAAC,KAAK;QAAE,OAAO;QAAM,oBAAM,8VAAC,6SAAQ;YAAC,MAAM;;;;;;IAAO;IACrE;QACE,IAAI,yHAAa,CAAC,KAAK;QACvB,OAAO;QACP,oBAAM,8VAAC;YAAI,WAAU;;;;;;IACvB;IACA;QACE,IAAI,yHAAa,CAAC,IAAI;QACtB,OAAO;QACP,oBAAM,8VAAC;YAAI,WAAU;sBAAU;;;;;;IACjC;IACA;QAAE,IAAI,yHAAa,CAAC,IAAI;QAAE,OAAO;QAAM,oBAAM,8VAAC,uTAAU;YAAC,MAAM;;;;;;IAAO;CACvE;AAEM,MAAM,cAAc;AACpB,MAAM,gBAAgB;AACtB,MAAM,kBAAkB;AACxB,MAAM,oBAAoB;AAC1B,MAAM,mBAAmB;AACzB,MAAM,sBAAsB"}},
    {"offset": {"line": 1066, "column": 0}, "map": {"version":3,"sources":["file:///Users/weili/work/generate-web/app/edit/page.tsx"],"sourcesContent":["'use client';\n\nimport { useRouter } from 'next/navigation';\nimport { ChevronLeft, Sparkles, Palette, ImageIcon, Check, Zap } from 'lucide-react';\nimport { useAppSelector, useAppDispatch } from '@/store/hooks';\nimport { \n  setPrompt, \n  setSelectedStyle, \n  setAspectRatio, \n  setImageSize, \n  setImageFormat,\n  setResultImage,\n  addToHistory,\n  resetImageState,\n} from '@/store/slices/imageSlice';\nimport { setLoadingState, setIsPaymentModalOpen } from '@/store/slices/appSlice';\nimport { LoadingState, UserTier } from '@/types';\nimport { updateSceneUsage, setUserTier } from '@/store/slices/userSlice';\nimport PaymentModal from '@/components/PaymentModal';\nimport { generateExtendedScene } from '@/services/geminiService';\nimport { PRESET_STYLES } from '@/lib/constants';\n\nconst FREE_DAILY_LIMIT = 5;\nconst PREMIUM_DAILY_LIMIT = 50;\n\nexport default function EditPage() {\n  const router = useRouter();\n  const dispatch = useAppDispatch();\n  const sourceImage = useAppSelector((state) => state.image.sourceImage);\n  const mimeType = useAppSelector((state) => state.image.mimeType);\n  const prompt = useAppSelector((state) => state.image.prompt);\n  const selectedStyle = useAppSelector((state) => state.image.selectedStyle);\n  const aspectRatio = useAppSelector((state) => state.image.aspectRatio);\n  const imageSize = useAppSelector((state) => state.image.imageSize);\n  const imageFormat = useAppSelector((state) => state.image.imageFormat);\n  const loadingState = useAppSelector((state) => state.app.loadingState);\n  const errorMsg = useAppSelector((state) => state.app.errorMsg);\n  const userTier = useAppSelector((state) => state.user.userTier);\n  const sceneUsage = useAppSelector((state) => state.user.sceneUsage);\n  const isPaymentModalOpen = useAppSelector((state) => state.app.isPaymentModalOpen);\n\n  const getLimit = () => userTier === 'PREMIUM' ? PREMIUM_DAILY_LIMIT : FREE_DAILY_LIMIT;\n  const isQuotaReached = () => {\n    const today = new Date().toLocaleDateString();\n    if (sceneUsage.date !== today) return false;\n    return sceneUsage.count >= getLimit();\n  };\n  const remainingQuota = () => {\n    const today = new Date().toLocaleDateString();\n    if (sceneUsage.date !== today) return getLimit();\n    return Math.max(0, getLimit() - sceneUsage.count);\n  };\n\n  const handleGenerate = async () => {\n    if (isQuotaReached()) {\n      alert(`Âú∫ÊôØÊâ©Â±ïÈ¢ùÂ∫¶‰∏çË∂≥ÔºÅÂâ©‰Ωô ${remainingQuota()} Ê¨°„ÄÇ\\n\\nÂçáÁ∫ß‰ºöÂëòÂèØËé∑ÂèñÊØèÊó• 50 Ê¨°Âú∫ÊôØÊâ©Â±ïÈ¢ùÂ∫¶„ÄÇ`);\n      dispatch(setIsPaymentModalOpen(true));\n      return;\n    }\n\n    if (!sourceImage || !prompt) {\n      return;\n    }\n\n    dispatch(setLoadingState(LoadingState.GENERATING));\n    router.push('/result');\n\n    try {\n      let finalPrompt = prompt;\n      let styleLabels = '';\n      if (selectedStyle) {\n        const styleObj = PRESET_STYLES.find((s) => s.id === selectedStyle);\n        if (styleObj) {\n          styleLabels = styleObj.label;\n          finalPrompt = `${prompt}. Style modifiers: ${styleObj.value}`;\n        }\n      }\n\n      const result = await generateExtendedScene(\n        sourceImage,\n        mimeType,\n        finalPrompt,\n        aspectRatio,\n        imageSize,\n        imageFormat\n      );\n      dispatch(updateSceneUsage(1));\n\n      const newHistoryItem = {\n        id: Date.now().toString(),\n        url: result,\n        timestamp: Date.now(),\n        prompt: prompt,\n        style: styleLabels,\n      };\n\n      dispatch(addToHistory(newHistoryItem));\n      dispatch(setResultImage(result));\n      dispatch(setLoadingState(LoadingState.SUCCESS));\n    } catch (err) {\n      console.error(err);\n      dispatch(setLoadingState(LoadingState.ERROR));\n    }\n  };\n\n  const quotaReached = isQuotaReached();\n\n  return (\n    <div className=\"flex flex-col min-h-screen bg-gray-50 pb-24 md:pt-16\">\n      <header className=\"bg-white px-4 md:hidden py-3 sticky top-0 z-10 shadow-sm border-b border-gray-100 flex items-center gap-4\">\n        <button\n          onClick={() => router.push('/create')}\n          className=\"p-2 hover:bg-gray-100 rounded-full transition-colors\"\n        >\n          <ChevronLeft size={24} className=\"text-gray-600\" />\n        </button>\n        <h2 className=\"font-bold text-lg text-gray-800\">ÂàõÊÑèÂ∑•Âùä</h2>\n        <div className=\"ml-auto\">\n          <div\n            className={`flex items-center gap-1 text-xs font-medium px-2 py-1 rounded-full border ${\n              quotaReached\n                ? 'bg-red-50 text-red-500 border-red-100'\n                : 'bg-violet-50 text-violet-600 border-violet-100'\n            }`}\n          >\n            <Zap size={12} fill=\"currentColor\" />\n            {remainingQuota()} / {getLimit()}\n          </div>\n        </div>\n      </header>\n\n      <div className=\"flex-1 p-6 md:p-12 space-y-6 overflow-y-auto max-w-6xl mx-auto w-full\">\n        {/* PCÁ´ØÊ∂àËÄóÊ¨°Êï∞Â±ïÁ§∫ */}\n        <div className=\"hidden md:flex items-center justify-end mb-2\">\n          <div\n            className={`flex items-center gap-2 text-sm font-medium px-4 py-2 rounded-full border ${\n              quotaReached\n                ? 'bg-red-50 text-red-600 border-red-200'\n                : 'bg-violet-50 text-violet-700 border-violet-200'\n            }`}\n          >\n            <Zap size={16} fill=\"currentColor\" />\n            <span className=\"font-semibold\">\n              {remainingQuota()} / {getLimit()}\n            </span>\n          </div>\n        </div>\n\n        <div className=\"md:grid md:grid-cols-2 md:gap-8 md:items-start\">\n          {/* Left Column - Image Preview */}\n          <div className=\"space-y-6\">\n            <div className=\"bg-white p-2 rounded-2xl shadow-sm border border-gray-100\">\n              {sourceImage && (\n                <img\n                  src={sourceImage}\n                  alt=\"Preview\"\n                  className=\"w-full h-48 md:h-64 object-contain bg-gray-100 rounded-xl\"\n                />\n              )}\n            </div>\n          </div>\n\n          {/* Right Column - Controls */}\n          <div className=\"space-y-6\">\n            <div className=\"space-y-3\">\n              <label className=\"text-sm font-semibold text-gray-800 ml-1 flex items-center gap-2\">\n                <Sparkles size={16} className=\"text-violet-500\" />\n                ‰Ω†ÊÉ≥Â¶Ç‰ΩïÊâ©Â±ïËøô‰∏™Âú∫ÊôØÔºü\n              </label>\n              <div className=\"relative\">\n                <textarea\n                  value={prompt}\n                  onChange={(e) => dispatch(setPrompt(e.target.value))}\n                  placeholder=\"‰æãÂ¶ÇÔºöËÆ©ËøôÂè™Áå´Âí™ÂùêÂú®ÂÖÖÊª°Êú™Êù•ÊÑüÁöÑÈúìËôπÂüéÂ∏ÇË°óÈÅì‰∏äÔºå‰∏ãÁùÄÂ∞èÈõ®...\"\n                  className=\"w-full p-4 md:p-6 pb-12 rounded-2xl border border-gray-200 bg-white focus:ring-2 focus:ring-violet-500 focus:border-transparent outline-none resize-none text-gray-700 shadow-sm h-32 md:h-40 text-sm md:text-base leading-relaxed\"\n                />\n              </div>\n            </div>\n\n            <div className=\"space-y-3\">\n              <label className=\"text-sm font-semibold text-gray-800 ml-1 flex items-center gap-2\">\n                <Palette size={16} className=\"text-violet-500\" />\n                Ëâ∫ÊúØÈ£éÊ†º\n              </label>\n              <div className=\"grid grid-cols-3 md:grid-cols-4 gap-3\">\n                {PRESET_STYLES.map((style) => {\n                  const isSelected = selectedStyle === style.id;\n                  return (\n                    <button\n                      key={style.id}\n                      onClick={() =>\n                        dispatch(setSelectedStyle(isSelected ? null : style.id))\n                      }\n                      className={`\n                        relative px-2 py-3 rounded-xl text-xs md:text-sm font-medium transition-all duration-200 border\n                        flex flex-col items-center justify-center gap-1 overflow-hidden\n                        ${\n                          isSelected\n                            ? 'bg-violet-50 border-violet-500 text-violet-700 shadow-sm ring-1 ring-violet-200'\n                            : 'bg-white border-gray-200 text-gray-600 hover:border-violet-200 hover:bg-gray-50'\n                        }\n                      `}\n                    >\n                      {isSelected && (\n                        <div className=\"absolute top-1 right-1\">\n                          <Check size={12} className=\"text-violet-600\" />\n                        </div>\n                      )}\n                      <span>{style.label}</span>\n                    </button>\n                  );\n                })}\n              </div>\n            </div>\n\n            <div className=\"space-y-3\">\n              <label className=\"text-sm font-semibold text-gray-800 ml-1 flex items-center gap-2\">\n                <ImageIcon size={16} className=\"text-violet-500\" />\n                ÂõæÁâáÊØî‰æã\n              </label>\n              <div className=\"grid grid-cols-5 gap-2\">\n                {[\n                  '1:1',\n                  '16:9',\n                  '9:16',\n                  '4:3',\n                  '3:4',\n                  '21:9',\n                  '3:2',\n                  '2:3',\n                  '5:4',\n                  '4:5',\n                ].map((ratio) => (\n                  <button\n                    key={ratio}\n                    onClick={() => dispatch(setAspectRatio(ratio))}\n                    className={`\n                      px-3 py-2 rounded-xl text-xs font-medium transition-all border\n                      ${\n                        aspectRatio === ratio\n                          ? 'bg-violet-50 border-violet-500 text-violet-700 shadow-sm ring-1 ring-violet-200'\n                          : 'bg-white border-gray-200 text-gray-600 hover:border-violet-200 hover:bg-gray-50'\n                      }\n                    `}\n                  >\n                    {ratio}\n                  </button>\n                ))}\n              </div>\n            </div>\n\n            <div className=\"space-y-3\">\n              <label className=\"text-sm font-semibold text-gray-800 ml-1 flex items-center gap-2\">\n                <ImageIcon size={16} className=\"text-violet-500\" />\n                ÂàÜËæ®Áéá\n              </label>\n              <div className=\"grid grid-cols-3 gap-3\">\n                {(['1K', '2K', '4K'] as const).map((size) => (\n                  <button\n                    key={size}\n                    onClick={() => dispatch(setImageSize(size))}\n                    className={`\n                      px-4 py-3 rounded-xl text-sm font-medium transition-all border\n                      ${\n                        imageSize === size\n                          ? 'bg-violet-50 border-violet-500 text-violet-700 shadow-sm ring-1 ring-violet-200'\n                          : 'bg-white border-gray-200 text-gray-600 hover:border-violet-200 hover:bg-gray-50'\n                      }\n                    `}\n                  >\n                    {size}\n                  </button>\n                ))}\n              </div>\n            </div>\n\n            <div className=\"space-y-3\">\n              <label className=\"text-sm font-semibold text-gray-800 ml-1 flex items-center gap-2\">\n                <ImageIcon size={16} className=\"text-violet-500\" />\n                ÂõæÁâáÊ†ºÂºè\n              </label>\n              <div className=\"grid grid-cols-3 gap-3\">\n                {(['PNG', 'JPEG', 'WEBP'] as const).map((format) => (\n                  <button\n                    key={format}\n                    onClick={() => dispatch(setImageFormat(format))}\n                    className={`\n                      px-4 py-3 rounded-xl text-sm font-medium transition-all border\n                      ${\n                        imageFormat === format\n                          ? 'bg-violet-50 border-violet-500 text-violet-700 shadow-sm ring-1 ring-violet-200'\n                          : 'bg-white border-gray-200 text-gray-600 hover:border-violet-200 hover:bg-gray-50'\n                      }\n                    `}\n                  >\n                    {format}\n                  </button>\n                ))}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"px-6 md:px-12 pb-4 pt-2 bg-gradient-to-t from-gray-50 to-transparent max-w-6xl mx-auto w-full\">\n        <button\n          onClick={handleGenerate}\n          disabled={!prompt.trim() || quotaReached}\n          className={`w-full py-4 rounded-2xl font-semibold shadow-lg flex items-center justify-center gap-2 transition-all active:scale-95\n            ${\n              !prompt.trim() || quotaReached\n                ? 'bg-gray-200 text-gray-400 cursor-not-allowed'\n                : 'bg-violet-600 text-white shadow-violet-200 hover:bg-violet-700'\n            }`}\n        >\n          {quotaReached ? (\n            <span>‰ªäÊó•È¢ùÂ∫¶Â∑≤Áî®ÂÆå</span>\n          ) : (\n            <>\n              <Sparkles size={18} />\n              Á´ãÂç≥ÁîüÊàê\n            </>\n          )}\n        </button>\n        {quotaReached && (\n          <p\n            onClick={() => router.push('/profile')}\n            className=\"text-center text-xs text-violet-600 mt-2 cursor-pointer hover:underline\"\n          >\n            ÂçáÁ∫ß‰ºöÂëòËé∑ÂèñÊõ¥Â§öÈ¢ùÂ∫¶ &rarr;\n          </p>\n        )}\n      </div>\n\n      {/* Payment Modal */}\n      <PaymentModal\n        isOpen={isPaymentModalOpen}\n        onClose={() => dispatch(setIsPaymentModalOpen(false))}\n        onSuccess={() => {\n          dispatch(setUserTier(UserTier.PREMIUM));\n          dispatch(setIsPaymentModalOpen(false));\n        }}\n        amount={29.9}\n        productName=\"IP ÂàõÊÉ≥Âùä‰ºöÂëò\"\n        productDesc=\"Ëß£ÈîÅÊØèÊó• 50 Ê¨°Âú∫ÊôØÊâ©Â±ïÂíå 50 Ê¨°Ë°®ÊÉÖÂåÖÂà∂‰ΩúÈ¢ùÂ∫¶\"\n      />\n    </div>\n  );\n}\n\n"],"names":[],"mappings":"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"}}]
}
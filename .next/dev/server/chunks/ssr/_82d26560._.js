module.exports = [
"[project]/app/providers/ReduxProvider.tsx [app-rsc] (client reference proxy) <module evaluation>", ((__turbopack_context__) => {
"use strict";

// This file is generated by next-core EcmascriptClientReferenceModule.
__turbopack_context__.s([
    "default",
    ()=>__TURBOPACK__default__export__
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$3_react$2d$dom$40$19$2e$2$2e$0_react$40$19$2e$2$2e$0_$5f$react$40$19$2e$2$2e$0$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$server$2d$dom$2d$turbopack$2d$server$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/next@16.0.3_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react-server-dom-turbopack-server.js [app-rsc] (ecmascript)");
;
const __TURBOPACK__default__export__ = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$3_react$2d$dom$40$19$2e$2$2e$0_react$40$19$2e$2$2e$0_$5f$react$40$19$2e$2$2e$0$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$server$2d$dom$2d$turbopack$2d$server$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerClientReference"])(function() {
    throw new Error("Attempted to call the default export of [project]/app/providers/ReduxProvider.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.");
}, "[project]/app/providers/ReduxProvider.tsx <module evaluation>", "default");
}),
"[project]/app/providers/ReduxProvider.tsx [app-rsc] (client reference proxy)", ((__turbopack_context__) => {
"use strict";

// This file is generated by next-core EcmascriptClientReferenceModule.
__turbopack_context__.s([
    "default",
    ()=>__TURBOPACK__default__export__
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$3_react$2d$dom$40$19$2e$2$2e$0_react$40$19$2e$2$2e$0_$5f$react$40$19$2e$2$2e$0$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$server$2d$dom$2d$turbopack$2d$server$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/next@16.0.3_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react-server-dom-turbopack-server.js [app-rsc] (ecmascript)");
;
const __TURBOPACK__default__export__ = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$3_react$2d$dom$40$19$2e$2$2e$0_react$40$19$2e$2$2e$0_$5f$react$40$19$2e$2$2e$0$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$server$2d$dom$2d$turbopack$2d$server$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerClientReference"])(function() {
    throw new Error("Attempted to call the default export of [project]/app/providers/ReduxProvider.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.");
}, "[project]/app/providers/ReduxProvider.tsx", "default");
}),
"[project]/app/providers/ReduxProvider.tsx [app-rsc] (ecmascript)", ((__turbopack_context__) => {
"use strict";

var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$providers$2f$ReduxProvider$2e$tsx__$5b$app$2d$rsc$5d$__$28$client__reference__proxy$29$__$3c$module__evaluation$3e$__ = __turbopack_context__.i("[project]/app/providers/ReduxProvider.tsx [app-rsc] (client reference proxy) <module evaluation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$providers$2f$ReduxProvider$2e$tsx__$5b$app$2d$rsc$5d$__$28$client__reference__proxy$29$__ = __turbopack_context__.i("[project]/app/providers/ReduxProvider.tsx [app-rsc] (client reference proxy)");
;
__turbopack_context__.n(__TURBOPACK__imported__module__$5b$project$5d2f$app$2f$providers$2f$ReduxProvider$2e$tsx__$5b$app$2d$rsc$5d$__$28$client__reference__proxy$29$__);
}),
"[project]/app/components/TabBarWrapper.tsx [app-rsc] (client reference proxy) <module evaluation>", ((__turbopack_context__) => {
"use strict";

// This file is generated by next-core EcmascriptClientReferenceModule.
__turbopack_context__.s([
    "default",
    ()=>__TURBOPACK__default__export__
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$3_react$2d$dom$40$19$2e$2$2e$0_react$40$19$2e$2$2e$0_$5f$react$40$19$2e$2$2e$0$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$server$2d$dom$2d$turbopack$2d$server$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/next@16.0.3_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react-server-dom-turbopack-server.js [app-rsc] (ecmascript)");
;
const __TURBOPACK__default__export__ = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$3_react$2d$dom$40$19$2e$2$2e$0_react$40$19$2e$2$2e$0_$5f$react$40$19$2e$2$2e$0$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$server$2d$dom$2d$turbopack$2d$server$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerClientReference"])(function() {
    throw new Error("Attempted to call the default export of [project]/app/components/TabBarWrapper.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.");
}, "[project]/app/components/TabBarWrapper.tsx <module evaluation>", "default");
}),
"[project]/app/components/TabBarWrapper.tsx [app-rsc] (client reference proxy)", ((__turbopack_context__) => {
"use strict";

// This file is generated by next-core EcmascriptClientReferenceModule.
__turbopack_context__.s([
    "default",
    ()=>__TURBOPACK__default__export__
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$3_react$2d$dom$40$19$2e$2$2e$0_react$40$19$2e$2$2e$0_$5f$react$40$19$2e$2$2e$0$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$server$2d$dom$2d$turbopack$2d$server$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/next@16.0.3_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react-server-dom-turbopack-server.js [app-rsc] (ecmascript)");
;
const __TURBOPACK__default__export__ = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$3_react$2d$dom$40$19$2e$2$2e$0_react$40$19$2e$2$2e$0_$5f$react$40$19$2e$2$2e$0$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$server$2d$dom$2d$turbopack$2d$server$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerClientReference"])(function() {
    throw new Error("Attempted to call the default export of [project]/app/components/TabBarWrapper.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.");
}, "[project]/app/components/TabBarWrapper.tsx", "default");
}),
"[project]/app/components/TabBarWrapper.tsx [app-rsc] (ecmascript)", ((__turbopack_context__) => {
"use strict";

var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$components$2f$TabBarWrapper$2e$tsx__$5b$app$2d$rsc$5d$__$28$client__reference__proxy$29$__$3c$module__evaluation$3e$__ = __turbopack_context__.i("[project]/app/components/TabBarWrapper.tsx [app-rsc] (client reference proxy) <module evaluation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$components$2f$TabBarWrapper$2e$tsx__$5b$app$2d$rsc$5d$__$28$client__reference__proxy$29$__ = __turbopack_context__.i("[project]/app/components/TabBarWrapper.tsx [app-rsc] (client reference proxy)");
;
__turbopack_context__.n(__TURBOPACK__imported__module__$5b$project$5d2f$app$2f$components$2f$TabBarWrapper$2e$tsx__$5b$app$2d$rsc$5d$__$28$client__reference__proxy$29$__);
}),
"[project]/types.ts [app-rsc] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "AnimationType",
    ()=>AnimationType,
    "AppView",
    ()=>AppView,
    "LoadingState",
    ()=>LoadingState,
    "PaymentMethod",
    ()=>PaymentMethod,
    "PaymentStatus",
    ()=>PaymentStatus,
    "UserTier",
    ()=>UserTier
]);
var AppView = /*#__PURE__*/ function(AppView) {
    AppView["HOME"] = "HOME";
    AppView["UPLOAD"] = "UPLOAD";
    AppView["EDIT"] = "EDIT";
    AppView["RESULT"] = "RESULT";
    AppView["PROFILE"] = "PROFILE";
    AppView["MEME_EDITOR"] = "MEME_EDITOR";
    return AppView;
}({});
var LoadingState = /*#__PURE__*/ function(LoadingState) {
    LoadingState["IDLE"] = "IDLE";
    LoadingState["UPLOADING"] = "UPLOADING";
    LoadingState["GENERATING"] = "GENERATING";
    LoadingState["ERROR"] = "ERROR";
    LoadingState["SUCCESS"] = "SUCCESS";
    return LoadingState;
}({});
var UserTier = /*#__PURE__*/ function(UserTier) {
    UserTier["FREE"] = "FREE";
    UserTier["PREMIUM"] = "PREMIUM";
    return UserTier;
}({});
var AnimationType = /*#__PURE__*/ function(AnimationType) {
    AnimationType["NONE"] = "none";
    AnimationType["SHAKE"] = "shake";
    AnimationType["PULSE"] = "pulse";
    AnimationType["ZOOM"] = "zoom";
    AnimationType["SPIN"] = "spin";
    return AnimationType;
}({});
var PaymentMethod = /*#__PURE__*/ function(PaymentMethod) {
    PaymentMethod["WECHAT"] = "WECHAT";
    PaymentMethod["ALIPAY"] = "ALIPAY";
    return PaymentMethod;
}({});
var PaymentStatus = /*#__PURE__*/ function(PaymentStatus) {
    PaymentStatus["PENDING"] = "PENDING";
    PaymentStatus["SUCCESS"] = "SUCCESS";
    PaymentStatus["FAILED"] = "FAILED";
    PaymentStatus["CANCELLED"] = "CANCELLED";
    return PaymentStatus;
}({});
}),
"[project]/lib/date-utils.ts [app-rsc] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * 日期工具函数
 * 统一日期格式，避免不同环境下的格式差异
 */ /**
 * 获取今天的日期字符串（格式：YYYY-MM-DD）
 */ __turbopack_context__.s([
    "getTodayDateString",
    ()=>getTodayDateString,
    "normalizeDateString",
    ()=>normalizeDateString
]);
function getTodayDateString() {
    const today = new Date();
    const year = today.getFullYear();
    const month = String(today.getMonth() + 1).padStart(2, '0');
    const day = String(today.getDate()).padStart(2, '0');
    return `${year}-${month}-${day}`;
}
function normalizeDateString(date) {
    if (date instanceof Date) {
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const day = String(date.getDate()).padStart(2, '0');
        return `${year}-${month}-${day}`;
    }
    // 如果是字符串，尝试解析
    const dateObj = new Date(date);
    if (!isNaN(dateObj.getTime())) {
        const year = dateObj.getFullYear();
        const month = String(dateObj.getMonth() + 1).padStart(2, '0');
        const day = String(dateObj.getDate()).padStart(2, '0');
        return `${year}-${month}-${day}`;
    }
    // 如果已经是 YYYY-MM-DD 格式，直接返回
    if (/^\d{4}-\d{2}-\d{2}$/.test(date)) {
        return date;
    }
    // 尝试解析其他格式（如 M/D/YYYY 或 YYYY/M/D）
    const parts = date.split(/[\/\-]/);
    if (parts.length === 3) {
        let year, month, day;
        // 判断格式：如果第一部分是4位数，则是 YYYY/M/D
        if (parts[0].length === 4) {
            year = parts[0];
            month = parts[1].padStart(2, '0');
            day = parts[2].padStart(2, '0');
        } else {
            // 否则是 M/D/YYYY
            month = parts[0].padStart(2, '0');
            day = parts[1].padStart(2, '0');
            year = parts[2];
        }
        return `${year}-${month}-${day}`;
    }
    // 如果无法解析，返回原字符串
    return date;
}
}),
"[project]/lib/server-auth.ts [app-rsc] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * 服务端认证工具函数
 * 用于在 SSR 侧获取用户信息
 */ __turbopack_context__.s([
    "getServerHistory",
    ()=>getServerHistory,
    "getServerUserId",
    ()=>getServerUserId,
    "getServerUserInfo",
    ()=>getServerUserInfo
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$3_react$2d$dom$40$19$2e$2$2e$0_react$40$19$2e$2$2e$0_$5f$react$40$19$2e$2$2e$0$2f$node_modules$2f$next$2f$headers$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/next@16.0.3_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/headers.js [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/types.ts [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$date$2d$utils$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/lib/date-utils.ts [app-rsc] (ecmascript)");
;
;
;
const USER_ID_KEY = 'ip_creative_user_id';
async function getServerUserId() {
    const cookieStore = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$3_react$2d$dom$40$19$2e$2$2e$0_react$40$19$2e$2$2e$0_$5f$react$40$19$2e$2$2e$0$2f$node_modules$2f$next$2f$headers$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["cookies"])();
    const userId = cookieStore.get(USER_ID_KEY);
    return userId?.value || null;
}
async function getServerUserInfo() {
    try {
        const userId = await getServerUserId();
        if (!userId) {
            const today = (0, __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$date$2d$utils$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["getTodayDateString"])();
            return {
                userTier: __TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["UserTier"].FREE,
                sceneUsage: {
                    date: today,
                    count: 0
                },
                memeUsage: {
                    date: today,
                    count: 0
                }
            };
        }
        // 直接从数据库获取用户信息（服务端）
        const { getUserInfoFromDB } = await __turbopack_context__.A("[project]/lib/db.ts [app-rsc] (ecmascript, async loader)");
        const userData = await getUserInfoFromDB(userId);
        if (!userData) {
            const today = (0, __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$date$2d$utils$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["getTodayDateString"])();
            return {
                userTier: __TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["UserTier"].FREE,
                sceneUsage: {
                    date: today,
                    count: 0
                },
                memeUsage: {
                    date: today,
                    count: 0
                }
            };
        }
        return userData;
    } catch (error) {
        console.error('Get server user info error:', error);
        const today = (0, __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$date$2d$utils$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["getTodayDateString"])();
        return {
            userTier: __TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["UserTier"].FREE,
            sceneUsage: {
                date: today,
                count: 0
            },
            memeUsage: {
                date: today,
                count: 0
            }
        };
    }
}
async function getServerHistory() {
    try {
        const userId = await getServerUserId();
        if (!userId) {
            return [];
        }
        // 直接从数据库获取历史记录（服务端）
        const { getCloudDB } = await __turbopack_context__.A("[project]/lib/db.ts [app-rsc] (ecmascript, async loader)");
        const { db } = await getCloudDB();
        const query = db.collection("history").where({
            userId: userId
        }).orderBy("timestamp", "desc").limit(50);
        const result = await query.get();
        const historyList = result.data.map((item)=>({
                id: item._id,
                url: item.url,
                timestamp: item.timestamp,
                prompt: item.prompt,
                style: item.style
            }));
        return historyList;
    } catch (error) {
        console.error('Get server history error:', error);
        return [];
    }
}
}),
"[project]/store/slices/userSlice.ts [app-rsc] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "UserStatus",
    ()=>UserStatus,
    "clearUserInfo",
    ()=>clearUserInfo,
    "default",
    ()=>__TURBOPACK__default__export__,
    "resetDailyUsage",
    ()=>resetDailyUsage,
    "setDailyUsage",
    ()=>setDailyUsage,
    "setMemeUsage",
    ()=>setMemeUsage,
    "setSceneUsage",
    ()=>setSceneUsage,
    "setUserId",
    ()=>setUserId,
    "setUserInfo",
    ()=>setUserInfo,
    "setUserPhone",
    ()=>setUserPhone,
    "setUserStatus",
    ()=>setUserStatus,
    "setUserTier",
    ()=>setUserTier,
    "updateMemeUsage",
    ()=>updateMemeUsage,
    "updateSceneUsage",
    ()=>updateSceneUsage,
    "updateUsage",
    ()=>updateUsage
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f40$reduxjs$2b$toolkit$40$2$2e$11$2e$0_react$2d$redux$40$9$2e$2$2e$0_$40$types$2b$react$40$19$2e$2$2e$7_react$40$19$2e$2$2e$0_redux$40$5$2e$0$2e$1_$5f$react$40$19$2e$2$2e$0$2f$node_modules$2f40$reduxjs$2f$toolkit$2f$dist$2f$redux$2d$toolkit$2e$modern$2e$mjs__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/@reduxjs+toolkit@2.11.0_react-redux@9.2.0_@types+react@19.2.7_react@19.2.0_redux@5.0.1__react@19.2.0/node_modules/@reduxjs/toolkit/dist/redux-toolkit.modern.mjs [app-rsc] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/types.ts [app-rsc] (ecmascript)");
;
;
var UserStatus = /*#__PURE__*/ function(UserStatus) {
    UserStatus["GUEST"] = "GUEST";
    UserStatus["LOGGED_IN"] = "LOGGED_IN";
    return UserStatus;
}({});
const initialState = {
    status: "GUEST",
    userId: null,
    phone: null,
    userTier: __TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["UserTier"].FREE,
    sceneUsage: {
        date: new Date().toLocaleDateString(),
        count: 0
    },
    memeUsage: {
        date: new Date().toLocaleDateString(),
        count: 0
    }
};
const userSlice = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f40$reduxjs$2b$toolkit$40$2$2e$11$2e$0_react$2d$redux$40$9$2e$2$2e$0_$40$types$2b$react$40$19$2e$2$2e$7_react$40$19$2e$2$2e$0_redux$40$5$2e$0$2e$1_$5f$react$40$19$2e$2$2e$0$2f$node_modules$2f40$reduxjs$2f$toolkit$2f$dist$2f$redux$2d$toolkit$2e$modern$2e$mjs__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__$3c$locals$3e$__["createSlice"])({
    name: 'user',
    initialState,
    reducers: {
        setUserStatus: (state, action)=>{
            state.status = action.payload;
        },
        setUserId: (state, action)=>{
            state.userId = action.payload;
        },
        setUserPhone: (state, action)=>{
            state.phone = action.payload;
        },
        setUserTier: (state, action)=>{
            state.userTier = action.payload;
        },
        setUserInfo: (state, action)=>{
            state.userId = action.payload.userId;
            state.phone = action.payload.phone;
            state.userTier = action.payload.userTier;
            state.status = "LOGGED_IN";
        },
        clearUserInfo: (state)=>{
            state.status = "GUEST";
            state.userId = null;
            state.phone = null;
            state.userTier = __TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["UserTier"].FREE;
            state.sceneUsage = {
                date: new Date().toLocaleDateString(),
                count: 0
            };
            state.memeUsage = {
                date: new Date().toLocaleDateString(),
                count: 0
            };
        },
        setSceneUsage: (state, action)=>{
            state.sceneUsage = action.payload;
        },
        setMemeUsage: (state, action)=>{
            state.memeUsage = action.payload;
        },
        // 兼容旧代码，保留 dailyUsage（映射到 sceneUsage）
        setDailyUsage: (state, action)=>{
            state.sceneUsage = action.payload;
        },
        updateSceneUsage: (state, action)=>{
            const today = new Date().toLocaleDateString();
            if (state.sceneUsage.date !== today) {
                state.sceneUsage = {
                    date: today,
                    count: action.payload
                };
            } else {
                state.sceneUsage.count += action.payload;
            }
        },
        updateMemeUsage: (state, action)=>{
            const today = new Date().toLocaleDateString();
            if (state.memeUsage.date !== today) {
                state.memeUsage = {
                    date: today,
                    count: action.payload
                };
            } else {
                state.memeUsage.count += action.payload;
            }
        },
        // 兼容旧代码
        updateUsage: (state, action)=>{
            const today = new Date().toLocaleDateString();
            if (state.sceneUsage.date !== today) {
                state.sceneUsage = {
                    date: today,
                    count: action.payload
                };
            } else {
                state.sceneUsage.count += action.payload;
            }
        },
        resetDailyUsage: (state)=>{
            const today = new Date().toLocaleDateString();
            if (state.sceneUsage.date !== today) {
                state.sceneUsage = {
                    date: today,
                    count: 0
                };
            }
            if (state.memeUsage.date !== today) {
                state.memeUsage = {
                    date: today,
                    count: 0
                };
            }
        }
    }
});
const { setUserStatus, setUserId, setUserPhone, setUserTier, setUserInfo, clearUserInfo, setSceneUsage, setMemeUsage, setDailyUsage, updateSceneUsage, updateMemeUsage, updateUsage, resetDailyUsage } = userSlice.actions;
const __TURBOPACK__default__export__ = userSlice.reducer;
}),
"[project]/app/layout.tsx [app-rsc] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "default",
    ()=>RootLayout,
    "dynamic",
    ()=>dynamic,
    "metadata",
    ()=>metadata
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$3_react$2d$dom$40$19$2e$2$2e$0_react$40$19$2e$2$2e$0_$5f$react$40$19$2e$2$2e$0$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/next@16.0.3_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react-jsx-dev-runtime.js [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$3_react$2d$dom$40$19$2e$2$2e$0_react$40$19$2e$2$2e$0_$5f$react$40$19$2e$2$2e$0$2f$node_modules$2f$next$2f$script$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/next@16.0.3_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/script.js [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$providers$2f$ReduxProvider$2e$tsx__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/app/providers/ReduxProvider.tsx [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$components$2f$TabBarWrapper$2e$tsx__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/app/components/TabBarWrapper.tsx [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$server$2d$auth$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/lib/server-auth.ts [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$store$2f$slices$2f$userSlice$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/store/slices/userSlice.ts [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/types.ts [app-rsc] (ecmascript)");
;
;
;
;
;
;
;
;
const metadata = {
    title: "IP 创想坊",
    description: "AI 赋能创意，一键生成场景与表情包"
};
const dynamic = "force-dynamic";
async function RootLayout({ children }) {
    // 在 SSR 侧获取用户信息和历史记录
    let userInfo;
    let history;
    try {
        userInfo = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$server$2d$auth$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["getServerUserInfo"])();
    } catch (error) {
        console.error("Get server user info error:", error);
        const today = new Date().toLocaleDateString();
        userInfo = {
            userId: undefined,
            phone: undefined,
            userTier: __TURBOPACK__imported__module__$5b$project$5d2f$types$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["UserTier"].FREE,
            sceneUsage: {
                date: today,
                count: 0
            },
            memeUsage: {
                date: today,
                count: 0
            }
        };
    }
    try {
        history = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$server$2d$auth$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["getServerHistory"])();
    } catch (error) {
        console.error("Get server history error:", error);
        history = [];
    }
    // 准备初始状态
    const initialUserState = {
        status: userInfo.userId ? __TURBOPACK__imported__module__$5b$project$5d2f$store$2f$slices$2f$userSlice$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["UserStatus"].LOGGED_IN : __TURBOPACK__imported__module__$5b$project$5d2f$store$2f$slices$2f$userSlice$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["UserStatus"].GUEST,
        userId: userInfo.userId || null,
        phone: userInfo.phone || null,
        userTier: userInfo.userTier,
        sceneUsage: userInfo.sceneUsage,
        memeUsage: userInfo.memeUsage
    };
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$3_react$2d$dom$40$19$2e$2$2e$0_react$40$19$2e$2$2e$0_$5f$react$40$19$2e$2$2e$0$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("html", {
        lang: "zh-CN",
        children: [
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$3_react$2d$dom$40$19$2e$2$2e$0_react$40$19$2e$2$2e$0_$5f$react$40$19$2e$2$2e$0$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("head", {
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$3_react$2d$dom$40$19$2e$2$2e$0_react$40$19$2e$2$2e$0_$5f$react$40$19$2e$2$2e$0$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("meta", {
                        name: "viewport",
                        content: "width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
                    }, void 0, false, {
                        fileName: "[project]/app/layout.tsx",
                        lineNumber: 62,
                        columnNumber: 9
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$3_react$2d$dom$40$19$2e$2$2e$0_react$40$19$2e$2$2e$0_$5f$react$40$19$2e$2$2e$0$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$3_react$2d$dom$40$19$2e$2$2e$0_react$40$19$2e$2$2e$0_$5f$react$40$19$2e$2$2e$0$2f$node_modules$2f$next$2f$script$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["default"], {
                        src: "https://cdnjs.cloudflare.com/ajax/libs/gifshot/0.3.2/gifshot.min.js",
                        strategy: "lazyOnload"
                    }, void 0, false, {
                        fileName: "[project]/app/layout.tsx",
                        lineNumber: 66,
                        columnNumber: 9
                    }, this)
                ]
            }, void 0, true, {
                fileName: "[project]/app/layout.tsx",
                lineNumber: 61,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$3_react$2d$dom$40$19$2e$2$2e$0_react$40$19$2e$2$2e$0_$5f$react$40$19$2e$2$2e$0$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])("body", {
                className: "bg-gray-50 text-gray-900 antialiased selection:bg-violet-200 selection:text-violet-900",
                style: {
                    backgroundColor: "#f9fafb"
                },
                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$3_react$2d$dom$40$19$2e$2$2e$0_react$40$19$2e$2$2e$0_$5f$react$40$19$2e$2$2e$0$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$app$2f$providers$2f$ReduxProvider$2e$tsx__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["default"], {
                    initialUserState: initialUserState,
                    initialHistory: history,
                    children: [
                        children,
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$0$2e$3_react$2d$dom$40$19$2e$2$2e$0_react$40$19$2e$2$2e$0_$5f$react$40$19$2e$2$2e$0$2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$app$2f$components$2f$TabBarWrapper$2e$tsx__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["default"], {}, void 0, false, {
                            fileName: "[project]/app/layout.tsx",
                            lineNumber: 80,
                            columnNumber: 11
                        }, this)
                    ]
                }, void 0, true, {
                    fileName: "[project]/app/layout.tsx",
                    lineNumber: 75,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "[project]/app/layout.tsx",
                lineNumber: 71,
                columnNumber: 7
            }, this)
        ]
    }, void 0, true, {
        fileName: "[project]/app/layout.tsx",
        lineNumber: 60,
        columnNumber: 5
    }, this);
}
}),
];

//# sourceMappingURL=_82d26560._.js.map
{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/weili/work/generate-web/lib/image-storage.ts"],"sourcesContent":["/**\n * 图片本地存储工具\n * 用于在 edit 页面持久化 sourceImage，避免刷新后丢失\n */\n\nconst SOURCE_IMAGE_KEY = 'ip_creative_source_image';\nconst SOURCE_IMAGE_MIME_TYPE_KEY = 'ip_creative_source_image_mime_type';\n\n/**\n * 保存源图片到 localStorage\n */\nexport const saveSourceImage = (image: string, mimeType: string) => {\n  try {\n    localStorage.setItem(SOURCE_IMAGE_KEY, image);\n    localStorage.setItem(SOURCE_IMAGE_MIME_TYPE_KEY, mimeType);\n  } catch (error) {\n    console.error('Failed to save source image to localStorage:', error);\n    // 如果存储失败（可能是存储空间不足），尝试清理旧数据\n    try {\n      localStorage.removeItem(SOURCE_IMAGE_KEY);\n      localStorage.removeItem(SOURCE_IMAGE_MIME_TYPE_KEY);\n      localStorage.setItem(SOURCE_IMAGE_KEY, image);\n      localStorage.setItem(SOURCE_IMAGE_MIME_TYPE_KEY, mimeType);\n    } catch (retryError) {\n      console.error('Failed to save source image after cleanup:', retryError);\n    }\n  }\n};\n\n/**\n * 从 localStorage 加载源图片\n */\nexport const loadSourceImage = (): { image: string; mimeType: string } | null => {\n  try {\n    const image = localStorage.getItem(SOURCE_IMAGE_KEY);\n    const mimeType = localStorage.getItem(SOURCE_IMAGE_MIME_TYPE_KEY);\n    if (image && mimeType) {\n      return { image, mimeType };\n    }\n  } catch (error) {\n    console.error('Failed to load source image from localStorage:', error);\n  }\n  return null;\n};\n\n/**\n * 清除源图片\n */\nexport const clearSourceImage = () => {\n  try {\n    localStorage.removeItem(SOURCE_IMAGE_KEY);\n    localStorage.removeItem(SOURCE_IMAGE_MIME_TYPE_KEY);\n  } catch (error) {\n    console.error('Failed to clear source image from localStorage:', error);\n  }\n};\n\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;AAED,MAAM,mBAAmB;AACzB,MAAM,6BAA6B;AAK5B,MAAM,kBAAkB,CAAC,OAAe;IAC7C,IAAI;QACF,aAAa,OAAO,CAAC,kBAAkB;QACvC,aAAa,OAAO,CAAC,4BAA4B;IACnD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gDAAgD;QAC9D,4BAA4B;QAC5B,IAAI;YACF,aAAa,UAAU,CAAC;YACxB,aAAa,UAAU,CAAC;YACxB,aAAa,OAAO,CAAC,kBAAkB;YACvC,aAAa,OAAO,CAAC,4BAA4B;QACnD,EAAE,OAAO,YAAY;YACnB,QAAQ,KAAK,CAAC,8CAA8C;QAC9D;IACF;AACF;AAKO,MAAM,kBAAkB;IAC7B,IAAI;QACF,MAAM,QAAQ,aAAa,OAAO,CAAC;QACnC,MAAM,WAAW,aAAa,OAAO,CAAC;QACtC,IAAI,SAAS,UAAU;YACrB,OAAO;gBAAE;gBAAO;YAAS;QAC3B;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kDAAkD;IAClE;IACA,OAAO;AACT;AAKO,MAAM,mBAAmB;IAC9B,IAAI;QACF,aAAa,UAAU,CAAC;QACxB,aAAa,UAAU,CAAC;IAC1B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mDAAmD;IACnE;AACF"}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file:///Users/weili/work/generate-web/app/create/page.tsx"],"sourcesContent":["'use client';\n\nimport { useRouter } from 'next/navigation';\nimport { ChevronLeft } from 'lucide-react';\nimport { useRef } from 'react';\nimport { useAppDispatch } from '@/store/hooks';\nimport { setSourceImage } from '@/store/slices/imageSlice';\nimport { saveSourceImage } from '@/lib/image-storage';\nimport { setCurrentView, AppView } from '@/store/slices/appSlice';\nimport { setMemeDrafts, setActiveDraftIndex } from '@/store/slices/memeSlice';\nimport { AnimationType } from '@/types';\n\nexport default function CreatePage() {\n  const router = useRouter();\n  const dispatch = useAppDispatch();\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const triggerFileInput = () => {\n    fileInputRef.current?.click();\n  };\n\n  const handleFileChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        const imageData = reader.result as string;\n        const mimeType = file.type;\n        \n        // 保存到 Redux\n        dispatch(setSourceImage({\n          image: imageData,\n          mimeType: mimeType,\n        }));\n        \n        // 保存到 localStorage（每次进入 edit 都会替换最新的图片）\n        saveSourceImage(imageData, mimeType);\n        \n        // 从 /create 页面上传的文件，应该跳转到场景扩展编辑页\n        router.push('/edit');\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col min-h-screen bg-gray-50 pb-24 md:pt-16\">\n      <header className=\"bg-white p-4 md:hidden sticky top-0 z-10 shadow-sm border-b border-gray-100 flex items-center justify-center relative\">\n        <button\n          onClick={() => router.push('/')}\n          className=\"absolute left-4 p-2 hover:bg-gray-100 rounded-full transition-colors\"\n        >\n          <ChevronLeft size={24} className=\"text-gray-600\" />\n        </button>\n        <h2 className=\"font-bold text-lg text-gray-800\">上传素材</h2>\n      </header>\n\n      <div className=\"flex-1 p-6 md:p-12 flex flex-col justify-center max-w-4xl mx-auto w-full\">\n        <div\n          onClick={triggerFileInput}\n          className=\"bg-white border-2 border-dashed border-violet-200 rounded-3xl p-10 md:p-16 flex flex-col items-center justify-center space-y-4 cursor-pointer hover:bg-violet-50 hover:border-violet-400 transition-all group min-h-[320px] md:min-h-[400px]\"\n        >\n          <div className=\"w-16 h-16 bg-violet-100 text-violet-600 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform\">\n            <svg\n              className=\"w-8 h-8\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              viewBox=\"0 0 24 24\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12\"\n              />\n            </svg>\n          </div>\n          <div className=\"text-center space-y-2\">\n            <p className=\"font-semibold text-gray-700\">点击上传图片</p>\n            <p className=\"text-xs text-gray-400\">支持 JPG, PNG (最大 5MB)</p>\n          </div>\n          <input\n            type=\"file\"\n            ref={fileInputRef}\n            className=\"hidden\"\n            accept=\"image/png, image/jpeg, image/webp\"\n            onChange={handleFileChange}\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AAPA;;;;;;;;AAYe,SAAS;IACtB,MAAM,SAAS,IAAA,gTAAS;IACxB,MAAM,WAAW,IAAA,gIAAc;IAC/B,MAAM,eAAe,IAAA,gXAAM,EAAmB;IAE9C,MAAM,mBAAmB;QACvB,aAAa,OAAO,EAAE;IACxB;IAEA,MAAM,mBAAmB,CAAC;QACxB,MAAM,OAAO,MAAM,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE;QACpC,IAAI,MAAM;YACR,MAAM,SAAS,IAAI;YACnB,OAAO,SAAS,GAAG;gBACjB,MAAM,YAAY,OAAO,MAAM;gBAC/B,MAAM,WAAW,KAAK,IAAI;gBAE1B,YAAY;gBACZ,SAAS,IAAA,+IAAc,EAAC;oBACtB,OAAO;oBACP,UAAU;gBACZ;gBAEA,wCAAwC;gBACxC,IAAA,0IAAe,EAAC,WAAW;gBAE3B,iCAAiC;gBACjC,OAAO,IAAI,CAAC;YACd;YACA,OAAO,aAAa,CAAC;QACvB;IACF;IAEA,qBACE,+YAAC;QAAI,WAAU;;0BACb,+YAAC;gBAAO,WAAU;;kCAChB,+YAAC;wBACC,SAAS,IAAM,OAAO,IAAI,CAAC;wBAC3B,WAAU;kCAEV,cAAA,+YAAC,uTAAW;4BAAC,MAAM;4BAAI,WAAU;;;;;;;;;;;kCAEnC,+YAAC;wBAAG,WAAU;kCAAkC;;;;;;;;;;;;0BAGlD,+YAAC;gBAAI,WAAU;0BACb,cAAA,+YAAC;oBACC,SAAS;oBACT,WAAU;;sCAEV,+YAAC;4BAAI,WAAU;sCACb,cAAA,+YAAC;gCACC,WAAU;gCACV,MAAK;gCACL,QAAO;gCACP,SAAQ;0CAER,cAAA,+YAAC;oCACC,eAAc;oCACd,gBAAe;oCACf,aAAa;oCACb,GAAE;;;;;;;;;;;;;;;;sCAIR,+YAAC;4BAAI,WAAU;;8CACb,+YAAC;oCAAE,WAAU;8CAA8B;;;;;;8CAC3C,+YAAC;oCAAE,WAAU;8CAAwB;;;;;;;;;;;;sCAEvC,+YAAC;4BACC,MAAK;4BACL,KAAK;4BACL,WAAU;4BACV,QAAO;4BACP,UAAU;;;;;;;;;;;;;;;;;;;;;;;AAMtB"}},
    {"offset": {"line": 234, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/.pnpm/lucide-react@0.554.0_react@19.2.0/node_modules/lucide-react/dist/esm/icons/chevron-left.js","sources":["file:///Users/weili/work/generate-web/node_modules/.pnpm/lucide-react%400.554.0_react%4019.2.0/node_modules/lucide-react/src/icons/chevron-left.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [['path', { d: 'm15 18-6-6 6-6', key: '1wnfg3' }]];\n\n/**\n * @component @name ChevronLeft\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMTUgMTgtNi02IDYtNiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/chevron-left\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ChevronLeft = createLucideIcon('chevron-left', __iconNode);\n\nexport default ChevronLeft;\n"],"names":[],"mappings":";;;;;;;;;;;;;AAGO,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAuB;IAAC;QAAC,MAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,gBAAA,CAAA;YAAkB,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAC;CAAA;AAarF,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,WAAA,CAAA,CAAA,KAAc,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,kPAAA,EAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAgB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA"}}]
}
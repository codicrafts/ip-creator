{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/weili/work/generate-web/lib/cloud.ts"],"sourcesContent":["/**\n * äº‘å‡½æ•°è°ƒç”¨å°è£…ï¼ˆé€šè¿‡ Next.js API è·¯ç”±ï¼‰\n * åœ¨æœåŠ¡ç«¯ä½¿ç”¨ wx-server-sdk è°ƒç”¨äº‘å‡½æ•°\n */\n\n// API åŸºç¡€è·¯å¾„\nconst API_BASE_URL = \"/api/cloud\";\n\n/**\n * è°ƒç”¨äº‘å‡½æ•°ï¼ˆé€šè¿‡ Next.js API è·¯ç”±ï¼‰\n * @param name äº‘å‡½æ•°åç§°\n * @param data ä¼ é€’ç»™äº‘å‡½æ•°çš„æ•°æ®\n * @returns äº‘å‡½æ•°è¿”å›ç»“æœ\n */\nexport const callCloudFunction = async (\n  name: string,\n  data: any = {}\n): Promise<any> => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/${name}`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      return {\n        success: 0,\n        message: error.message || `HTTP è¯·æ±‚å¤±è´¥: ${response.status}`,\n      };\n    }\n\n    const result = await response.json();\n\n    // å¦‚æœ API è¿”å›çš„ success ä¸æ˜¯ 1ï¼Œè¿”å›å¤±è´¥ç»“æœ\n    if (result.success !== 1) {\n      return {\n        success: 0,\n        message: result.message || \"è°ƒç”¨äº‘å‡½æ•°å¤±è´¥\",\n      };\n    }\n\n    // æˆåŠŸæ—¶è¿”å›åŒ…å« success: 1 çš„ç»“æœ\n    return {\n      success: 1,\n      ...result,\n    };\n  } catch (error: any) {\n    console.error(`è°ƒç”¨äº‘å‡½æ•° ${name} å¤±è´¥:`, error);\n    return {\n      success: 0,\n      message: error.message || `è°ƒç”¨äº‘å‡½æ•° ${name} å¤±è´¥`,\n    };\n  }\n};\n"],"names":[],"mappings":"AAAA;;;CAGC,GAED,WAAW;;;;;AACX,MAAM,eAAe;AAQd,MAAM,oBAAoB,OAC/B,MACA,OAAY,CAAC,CAAC;IAEd,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,GAAG,aAAa,CAAC,EAAE,MAAM,EAAE;YACtD,QAAQ;YACR,SAAS;gBACP,gBAAgB;YAClB;YACA,MAAM,KAAK,SAAS,CAAC;QACvB;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,QAAQ,MAAM,SAAS,IAAI;YACjC,OAAO;gBACL,SAAS;gBACT,SAAS,MAAM,OAAO,IAAI,CAAC,WAAW,EAAE,SAAS,MAAM,EAAE;YAC3D;QACF;QAEA,MAAM,SAAS,MAAM,SAAS,IAAI;QAElC,iCAAiC;QACjC,IAAI,OAAO,OAAO,KAAK,GAAG;YACxB,OAAO;gBACL,SAAS;gBACT,SAAS,OAAO,OAAO,IAAI;YAC7B;QACF;QAEA,yBAAyB;QACzB,OAAO;YACL,SAAS;YACT,GAAG,MAAM;QACX;IACF,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,CAAC,MAAM,EAAE,KAAK,IAAI,CAAC,EAAE;QACnC,OAAO;YACL,SAAS;YACT,SAAS,MAAM,OAAO,IAAI,CAAC,MAAM,EAAE,KAAK,GAAG,CAAC;QAC9C;IACF;AACF"}},
    {"offset": {"line": 54, "column": 0}, "map": {"version":3,"sources":["file:///Users/weili/work/generate-web/lib/cookies.ts"],"sourcesContent":["/**\n * Cookie å·¥å…·å‡½æ•°\n * ç”¨äºæŒä¹…åŒ–ç”¨æˆ·ç™»å½•çŠ¶æ€ï¼ˆåªå­˜å‚¨ç”¨æˆ·IDï¼‰\n */\n\nimport { getCookie, setCookie, deleteCookie } from 'cookies-next';\n\n// Cookie é”®å\nconst USER_ID_KEY = 'ip_creative_user_id';\n\n// Cookie é€‰é¡¹ï¼ˆ30å¤©è¿‡æœŸï¼‰\nconst COOKIE_OPTIONS = {\n  maxAge: 60 * 60 * 24 * 30, // 30å¤©\n  path: '/',\n  sameSite: 'lax' as const,\n} as const;\n\n/**\n * ä¿å­˜ç”¨æˆ·IDåˆ° cookie\n */\nexport const setUserId = (userId: string) => {\n  setCookie(USER_ID_KEY, userId, COOKIE_OPTIONS);\n};\n\n/**\n * ä» cookie è·å–ç”¨æˆ·ID\n */\nexport const getUserId = (): string | null => {\n  const userId = getCookie(USER_ID_KEY);\n  return userId ? String(userId) : null;\n};\n\n/**\n * æ¸…é™¤ç”¨æˆ·ID cookie\n */\nexport const clearUserId = () => {\n  deleteCookie(USER_ID_KEY);\n};\n\n/**\n * æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½•ï¼ˆé€šè¿‡ cookieï¼‰\n */\nexport const isAuthenticated = (): boolean => {\n  return !!getUserId();\n};\n\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;;;AAED;;AAEA,YAAY;AACZ,MAAM,cAAc;AAEpB,mBAAmB;AACnB,MAAM,iBAAiB;IACrB,QAAQ,KAAK,KAAK,KAAK;IACvB,MAAM;IACN,UAAU;AACZ;AAKO,MAAM,YAAY,CAAC;IACxB,IAAA,sXAAS,EAAC,aAAa,QAAQ;AACjC;AAKO,MAAM,YAAY;IACvB,MAAM,SAAS,IAAA,sXAAS,EAAC;IACzB,OAAO,SAAS,OAAO,UAAU;AACnC;AAKO,MAAM,cAAc;IACzB,IAAA,yXAAY,EAAC;AACf;AAKO,MAAM,kBAAkB;IAC7B,OAAO,CAAC,CAAC;AACX"}},
    {"offset": {"line": 94, "column": 0}, "map": {"version":3,"sources":["file:///Users/weili/work/generate-web/services/historyService.ts"],"sourcesContent":["/**\n * å†å²è®°å½•æœåŠ¡\n * ç”¨äºä¿å­˜å’Œè·å–ç”¨æˆ·çš„åˆ›ä½œå†å²\n */\n\nimport { GeneratedImage } from '@/types';\nimport { callCloudFunction } from '@/lib/cloud';\nimport { getUserId } from '@/lib/cookies';\n\nexport interface HistoryItem extends GeneratedImage {\n  userId?: string;\n  type: 'scene' | 'meme'; // åœºæ™¯æ‰©å±•æˆ–è¡¨æƒ…åŒ…\n  createdAt?: Date;\n}\n\nexport interface SaveHistoryRequest {\n  userId?: string;\n  type: 'scene' | 'meme';\n  url: string;\n  prompt: string;\n  style?: string;\n}\n\n/**\n * ä¿å­˜å†å²è®°å½•åˆ°æ•°æ®åº“\n */\nexport const saveHistory = async (\n  type: 'scene' | 'meme',\n  url: string,\n  prompt: string,\n  style?: string\n): Promise<HistoryItem | null> => {\n  try {\n    const userId = getUserId();\n\n    const result = await callCloudFunction('history', {\n      action: 'save',\n      userId: userId || undefined,\n      type,\n      url,\n      prompt,\n      style,\n    });\n\n    if (result.success !== 1) {\n      console.error('Failed to save history:', result.message);\n      return null;\n    }\n\n    return result.data;\n  } catch (error) {\n    console.error('Save history error:', error);\n    return null;\n  }\n};\n\n/**\n * è·å–ç”¨æˆ·çš„å†å²è®°å½•åˆ—è¡¨\n */\nexport const getHistory = async (\n  userId?: string,\n  limit: number = 50\n): Promise<HistoryItem[]> => {\n  try {\n    const targetUserId = userId || getUserId();\n\n    if (!targetUserId) {\n      return [];\n    }\n\n    const result = await callCloudFunction('history', {\n      action: 'getList',\n      userId: targetUserId,\n      limit,\n    });\n\n    if (result.success !== 1) {\n      console.error('Failed to get history:', result.message);\n      return [];\n    }\n\n    return result.data || [];\n  } catch (error) {\n    console.error('Get history error:', error);\n    return [];\n  }\n};\n\n/**\n * åˆ é™¤å†å²è®°å½•\n */\nexport const deleteHistory = async (historyId: string): Promise<boolean> => {\n  try {\n    const userId = getUserId();\n\n    const result = await callCloudFunction('history', {\n      action: 'delete',\n      userId: userId || undefined,\n      historyId,\n    });\n\n    return result.success === 1;\n  } catch (error) {\n    console.error('Delete history error:', error);\n    return false;\n  }\n};\n\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;AAGD;AACA;;;AAmBO,MAAM,cAAc,OACzB,MACA,KACA,QACA;IAEA,IAAI;QACF,MAAM,SAAS,IAAA,2HAAS;QAExB,MAAM,SAAS,MAAM,IAAA,iIAAiB,EAAC,WAAW;YAChD,QAAQ;YACR,QAAQ,UAAU;YAClB;YACA;YACA;YACA;QACF;QAEA,IAAI,OAAO,OAAO,KAAK,GAAG;YACxB,QAAQ,KAAK,CAAC,2BAA2B,OAAO,OAAO;YACvD,OAAO;QACT;QAEA,OAAO,OAAO,IAAI;IACpB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO;IACT;AACF;AAKO,MAAM,aAAa,OACxB,QACA,QAAgB,EAAE;IAElB,IAAI;QACF,MAAM,eAAe,UAAU,IAAA,2HAAS;QAExC,IAAI,CAAC,cAAc;YACjB,OAAO,EAAE;QACX;QAEA,MAAM,SAAS,MAAM,IAAA,iIAAiB,EAAC,WAAW;YAChD,QAAQ;YACR,QAAQ;YACR;QACF;QAEA,IAAI,OAAO,OAAO,KAAK,GAAG;YACxB,QAAQ,KAAK,CAAC,0BAA0B,OAAO,OAAO;YACtD,OAAO,EAAE;QACX;QAEA,OAAO,OAAO,IAAI,IAAI,EAAE;IAC1B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,sBAAsB;QACpC,OAAO,EAAE;IACX;AACF;AAKO,MAAM,gBAAgB,OAAO;IAClC,IAAI;QACF,MAAM,SAAS,IAAA,2HAAS;QAExB,MAAM,SAAS,MAAM,IAAA,iIAAiB,EAAC,WAAW;YAChD,QAAQ;YACR,QAAQ,UAAU;YAClB;QACF;QAEA,OAAO,OAAO,OAAO,KAAK;IAC5B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO;IACT;AACF"}},
    {"offset": {"line": 169, "column": 0}, "map": {"version":3,"sources":["file:///Users/weili/work/generate-web/services/userService.ts"],"sourcesContent":["import { UserTier, DailyUsage } from \"@/types\";\nimport { callCloudFunction } from \"@/lib/cloud\";\nimport { getUserId } from \"@/lib/cookies\";\n\nexport interface UserInfo {\n  userId?: string;\n  phone?: string;\n  userTier: UserTier;\n  sceneUsage: DailyUsage;\n  memeUsage: DailyUsage;\n}\n\n/**\n * è·å–ç”¨æˆ·ä¿¡æ¯ï¼ˆåŒ…æ‹¬ä½¿ç”¨æ¬¡æ•°ï¼‰\n * @param userId ç”¨æˆ·IDï¼ˆå¯é€‰ï¼Œå¦‚æœä¸æä¾›åˆ™ä» localStorage æˆ– cookie è·å–ï¼‰\n * @returns ç”¨æˆ·ä¿¡æ¯\n */\nexport const getUserInfo = async (userId?: string): Promise<UserInfo> => {\n  try {\n    // å¦‚æœæ²¡æœ‰æä¾› userIdï¼Œå°è¯•ä» cookie è·å–\n    const storedUserId = userId || getUserId();\n\n    if (!storedUserId) {\n      return {\n        userTier: UserTier.FREE,\n        sceneUsage: { date: new Date().toLocaleDateString(), count: 0 },\n        memeUsage: { date: new Date().toLocaleDateString(), count: 0 },\n      };\n    }\n\n    const result = await callCloudFunction(\"user\", {\n      action: \"getInfo\",\n      userId: storedUserId,\n    });\n\n    // å¤„ç†äº‘å‡½æ•°è¿”å›ç»“æœï¼ˆAPI è·¯ç”±ç›´æ¥è¿”å› { success, data }ï¼‰\n    const response = result;\n\n    if (response.success !== 1) {\n      if (response.message === \"ç”¨æˆ·ä¸å­˜åœ¨\") {\n        return {\n          userTier: UserTier.FREE,\n          sceneUsage: { date: new Date().toLocaleDateString(), count: 0 },\n          memeUsage: { date: new Date().toLocaleDateString(), count: 0 },\n        };\n      }\n      throw new Error(response.message || \"è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥\");\n    }\n\n    const data = response.data;\n\n    return {\n      userId: data.userId,\n      phone: data.phone,\n      userTier: data.userTier || UserTier.FREE,\n      sceneUsage: data.sceneUsage || {\n        date: new Date().toLocaleDateString(),\n        count: 0,\n      },\n      memeUsage: data.memeUsage || {\n        date: new Date().toLocaleDateString(),\n        count: 0,\n      },\n    };\n  } catch (error) {\n    console.error(\"Get user info error:\", error);\n    // è¿”å›é»˜è®¤å€¼è€Œä¸æ˜¯æŠ›å‡ºé”™è¯¯ï¼Œç¡®ä¿åº”ç”¨å¯ä»¥ç»§ç»­è¿è¡Œ\n    return {\n      userTier: UserTier.FREE,\n      sceneUsage: { date: new Date().toLocaleDateString(), count: 0 },\n      memeUsage: { date: new Date().toLocaleDateString(), count: 0 },\n    };\n  }\n};\n\n/**\n * æ›´æ–°åœºæ™¯æ‰©å±•ä½¿ç”¨æ¬¡æ•°\n * @param userId ç”¨æˆ·ID\n * @param increment å¢åŠ çš„æ•°é‡ï¼ˆé»˜è®¤ä¸º 1ï¼‰\n * @returns æ›´æ–°åçš„ä½¿ç”¨æ¬¡æ•°\n */\nexport const updateSceneUsage = async (\n  userId: string,\n  increment: number = 1\n): Promise<DailyUsage> => {\n  try {\n    const result = await callCloudFunction(\"user\", {\n      action: \"updateSceneUsage\",\n      userId,\n      increment,\n    });\n\n    // å¤„ç†äº‘å‡½æ•°è¿”å›ç»“æœï¼ˆAPI è·¯ç”±ç›´æ¥è¿”å› { success, data }ï¼‰\n    const response = result;\n\n    if (response.success !== 1) {\n      throw new Error(response.message || \"æ›´æ–°åœºæ™¯æ‰©å±•ä½¿ç”¨æ¬¡æ•°å¤±è´¥\");\n    }\n\n    return response.data.sceneUsage;\n  } catch (error: any) {\n    console.error(\"Update scene usage error:\", error);\n    throw new Error(error.message || \"æ›´æ–°åœºæ™¯æ‰©å±•ä½¿ç”¨æ¬¡æ•°å¤±è´¥\");\n  }\n};\n\n/**\n * æ›´æ–°è¡¨æƒ…åŒ…åˆ¶ä½œä½¿ç”¨æ¬¡æ•°\n * @param userId ç”¨æˆ·ID\n * @param increment å¢åŠ çš„æ•°é‡ï¼ˆé»˜è®¤ä¸º 1ï¼‰\n * @returns æ›´æ–°åçš„ä½¿ç”¨æ¬¡æ•°\n */\nexport const updateMemeUsage = async (\n  userId: string,\n  increment: number = 1\n): Promise<DailyUsage> => {\n  try {\n    const result = await callCloudFunction(\"user\", {\n      action: \"updateMemeUsage\",\n      userId,\n      increment,\n    });\n\n    // å¤„ç†äº‘å‡½æ•°è¿”å›ç»“æœï¼ˆAPI è·¯ç”±ç›´æ¥è¿”å› { success, data }ï¼‰\n    const response = result;\n\n    if (response.success !== 1) {\n      throw new Error(response.message || \"æ›´æ–°è¡¨æƒ…åŒ…åˆ¶ä½œä½¿ç”¨æ¬¡æ•°å¤±è´¥\");\n    }\n\n    return response.data.memeUsage;\n  } catch (error: any) {\n    console.error(\"Update meme usage error:\", error);\n    throw new Error(error.message || \"æ›´æ–°è¡¨æƒ…åŒ…åˆ¶ä½œä½¿ç”¨æ¬¡æ•°å¤±è´¥\");\n  }\n};\n\n/**\n * æ›´æ–°ç”¨æˆ·ä¼šå‘˜ç­‰çº§\n * @param userId ç”¨æˆ·ID\n * @param userTier æ–°çš„ä¼šå‘˜ç­‰çº§\n * @returns æ›´æ–°åçš„ç”¨æˆ·ä¿¡æ¯\n */\nexport const updateUserTier = async (\n  userId: string,\n  userTier: UserTier\n): Promise<UserInfo> => {\n  try {\n    const result = await callCloudFunction(\"user\", {\n      action: \"updateTier\",\n      userId,\n      userTier,\n    });\n\n    // å¤„ç†äº‘å‡½æ•°è¿”å›ç»“æœï¼ˆAPI è·¯ç”±ç›´æ¥è¿”å› { success, data }ï¼‰\n    const response = result;\n\n    if (response.success !== 1) {\n      throw new Error(response.message || \"æ›´æ–°ä¼šå‘˜ç­‰çº§å¤±è´¥\");\n    }\n\n    const data = response.data;\n    return {\n      userId: data.userId,\n      userTier: data.userTier,\n      sceneUsage: data.sceneUsage,\n      memeUsage: data.memeUsage,\n    };\n  } catch (error: any) {\n    console.error(\"Update user tier error:\", error);\n    throw new Error(error.message || \"æ›´æ–°ä¼šå‘˜ç­‰çº§å¤±è´¥\");\n  }\n};\n\n/**\n * åˆ›å»ºæˆ–åˆå§‹åŒ–ç”¨æˆ·\n * @returns ç”¨æˆ·ä¿¡æ¯\n */\nexport const createOrInitUser = async (): Promise<UserInfo> => {\n  try {\n    // é€šè¿‡ API è·¯ç”±è°ƒç”¨ï¼ˆå¦‚æœéœ€è¦å®ç°åˆå§‹åŒ–åŠŸèƒ½ï¼‰\n    const result = await callCloudFunction(\"user\", {\n      action: \"init\",\n    });\n\n    const response = result;\n\n    if (response.success !== 1) {\n      throw new Error(response.message || \"åˆå§‹åŒ–ç”¨æˆ·å¤±è´¥\");\n    }\n\n    const data = response.data;\n\n    // ä¿å­˜ userId åˆ° cookieï¼ˆå¦‚æœéœ€è¦ï¼‰\n    if (data.userId) {\n      const { setUserId } = await import(\"@/lib/cookies\");\n      setUserId(data.userId);\n    }\n\n    return {\n      userId: data.userId,\n      userTier: data.userTier || UserTier.FREE,\n      sceneUsage: data.sceneUsage || {\n        date: new Date().toLocaleDateString(),\n        count: 0,\n      },\n      memeUsage: data.memeUsage || {\n        date: new Date().toLocaleDateString(),\n        count: 0,\n      },\n    };\n  } catch (error: any) {\n    console.error(\"Create or init user error:\", error);\n    throw new Error(error.message || \"åˆå§‹åŒ–ç”¨æˆ·å¤±è´¥\");\n  }\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 353, "column": 0}, "map": {"version":3,"sources":["file:///Users/weili/work/generate-web/services/authService.ts"],"sourcesContent":["import { callCloudFunction } from \"@/lib/cloud\";\nimport {\n  setUserId,\n  clearUserId,\n  getUserId,\n  isAuthenticated as isAuthenticatedCookie,\n} from \"@/lib/cookies\";\nimport { getUserInfo } from \"@/services/userService\";\n\nexport interface LoginRequest {\n  phone: string;\n  password: string;\n}\n\nexport interface LoginResponse {\n  userId: string;\n  phone: string;\n  userTier: \"FREE\" | \"PREMIUM\";\n  token?: string;\n}\n\nexport interface RegisterRequest {\n  phone: string;\n  password: string;\n}\n\nexport interface RegisterResponse {\n  userId: string;\n  phone: string;\n  userTier: \"FREE\";\n  token?: string;\n}\n\n/**\n * ç”¨æˆ·ç™»å½•\n * @param phone æ‰‹æœºå·\n * @param password å¯†ç \n * @returns ç™»å½•å“åº”\n */\nexport const login = async (\n  phone: string,\n  password: string\n): Promise<LoginResponse> => {\n  try {\n    const result = await callCloudFunction(\"auth\", {\n      action: \"login\",\n      phone,\n      password,\n    });\n    console.log(\"result\", result);\n\n    // å¤„ç†äº‘å‡½æ•°è¿”å›ç»“æœï¼ˆAPI è·¯ç”±ç›´æ¥è¿”å› { success, data }ï¼‰\n    const response = result;\n\n    if (response.success !== 1) {\n      throw new Error(response.message || \"ç™»å½•å¤±è´¥\");\n    }\n\n    const data = response.data;\n\n    // åªä¿å­˜ç”¨æˆ·IDåˆ° cookieï¼ˆæŒä¹…åŒ–ç™»å½•æ€ï¼‰\n    setUserId(data.userId);\n\n    return {\n      userId: data.userId,\n      phone: data.phone,\n      userTier: data.userTier,\n    };\n  } catch (error: any) {\n    console.error(\"Login error:\", error);\n    throw new Error(error.message || \"ç™»å½•å¤±è´¥\");\n  }\n};\n\n/**\n * ç”¨æˆ·æ³¨å†Œ\n * @param phone æ‰‹æœºå·\n * @param password å¯†ç \n * @returns æ³¨å†Œå“åº”\n */\nexport const register = async (\n  phone: string,\n  password: string\n): Promise<RegisterResponse> => {\n  try {\n    const result = await callCloudFunction(\"auth\", {\n      action: \"register\",\n      phone,\n      password,\n    });\n\n    // å¤„ç†äº‘å‡½æ•°è¿”å›ç»“æœï¼ˆAPI è·¯ç”±ç›´æ¥è¿”å› { success, data }ï¼‰\n    const response = result;\n\n    if (response.success !== 1) {\n      throw new Error(response.message || \"æ³¨å†Œå¤±è´¥\");\n    }\n\n    const data = response.data;\n\n    // åªä¿å­˜ç”¨æˆ·IDåˆ° cookieï¼ˆæŒä¹…åŒ–ç™»å½•æ€ï¼‰\n    setUserId(data.userId);\n\n    return {\n      userId: data.userId,\n      phone: data.phone,\n      userTier: data.userTier,\n    };\n  } catch (error: any) {\n    console.error(\"Register error:\", error);\n    throw new Error(error.message || \"æ³¨å†Œå¤±è´¥\");\n  }\n};\n\n/**\n * ç”¨æˆ·ç™»å‡º\n */\nexport const logout = async (): Promise<void> => {\n  try {\n    // å¾®ä¿¡äº‘å¼€å‘ä¸éœ€è¦æœåŠ¡ç«¯ç™»å‡ºï¼Œç›´æ¥æ¸…é™¤ cookie å³å¯\n  } catch (error) {\n    console.error(\"Logout error:\", error);\n  } finally {\n    // æ¸…é™¤ cookie\n    clearUserId();\n    // æ¸…é™¤æœ¬åœ°å­˜å‚¨çš„ä½¿ç”¨æ¬¡æ•°ï¼ˆæ¸¸å®¢çŠ¶æ€ä½¿ç”¨ï¼‰\n    localStorage.removeItem(\"ip_creative_scene_usage\");\n    localStorage.removeItem(\"ip_creative_meme_usage\");\n  }\n};\n\n/**\n * æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½•\n * @returns æ˜¯å¦å·²ç™»å½•\n */\nexport const isAuthenticated = (): boolean => {\n  return isAuthenticatedCookie();\n};\n\n/**\n * è·å–å½“å‰ç”¨æˆ·ID\n * @returns ç”¨æˆ·IDæˆ–null\n */\nexport const getCurrentUserId = (): string | null => {\n  return getUserId();\n};\n\n/**\n * è·å–å½“å‰ç”¨æˆ·æ‰‹æœºå·ï¼ˆä»åç«¯è·å–ï¼‰\n * @returns æ‰‹æœºå·æˆ–null\n */\nexport const getCurrentUserPhone = async (): Promise<string | null> => {\n  const userId = getUserId();\n  if (!userId) {\n    return null;\n  }\n  try {\n    const userInfo = await getUserInfo(userId);\n    return userInfo.phone || null;\n  } catch (error) {\n    console.error(\"Failed to get user phone:\", error);\n    return null;\n  }\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;AACA;AAMA;;;;AAgCO,MAAM,QAAQ,OACnB,OACA;IAEA,IAAI;QACF,MAAM,SAAS,MAAM,IAAA,iIAAiB,EAAC,QAAQ;YAC7C,QAAQ;YACR;YACA;QACF;QACA,QAAQ,GAAG,CAAC,UAAU;QAEtB,0CAA0C;QAC1C,MAAM,WAAW;QAEjB,IAAI,SAAS,OAAO,KAAK,GAAG;YAC1B,MAAM,IAAI,MAAM,SAAS,OAAO,IAAI;QACtC;QAEA,MAAM,OAAO,SAAS,IAAI;QAE1B,0BAA0B;QAC1B,IAAA,2HAAS,EAAC,KAAK,MAAM;QAErB,OAAO;YACL,QAAQ,KAAK,MAAM;YACnB,OAAO,KAAK,KAAK;YACjB,UAAU,KAAK,QAAQ;QACzB;IACF,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;IACnC;AACF;AAQO,MAAM,WAAW,OACtB,OACA;IAEA,IAAI;QACF,MAAM,SAAS,MAAM,IAAA,iIAAiB,EAAC,QAAQ;YAC7C,QAAQ;YACR;YACA;QACF;QAEA,0CAA0C;QAC1C,MAAM,WAAW;QAEjB,IAAI,SAAS,OAAO,KAAK,GAAG;YAC1B,MAAM,IAAI,MAAM,SAAS,OAAO,IAAI;QACtC;QAEA,MAAM,OAAO,SAAS,IAAI;QAE1B,0BAA0B;QAC1B,IAAA,2HAAS,EAAC,KAAK,MAAM;QAErB,OAAO;YACL,QAAQ,KAAK,MAAM;YACnB,OAAO,KAAK,KAAK;YACjB,UAAU,KAAK,QAAQ;QACzB;IACF,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,mBAAmB;QACjC,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;IACnC;AACF;AAKO,MAAM,SAAS;IACpB,IAAI;IACF,+BAA+B;IACjC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,iBAAiB;IACjC,SAAU;QACR,YAAY;QACZ,IAAA,6HAAW;QACX,sBAAsB;QACtB,aAAa,UAAU,CAAC;QACxB,aAAa,UAAU,CAAC;IAC1B;AACF;AAMO,MAAM,kBAAkB;IAC7B,OAAO,IAAA,iIAAqB;AAC9B;AAMO,MAAM,mBAAmB;IAC9B,OAAO,IAAA,2HAAS;AAClB;AAMO,MAAM,sBAAsB;IACjC,MAAM,SAAS,IAAA,2HAAS;IACxB,IAAI,CAAC,QAAQ;QACX,OAAO;IACT;IACA,IAAI;QACF,MAAM,WAAW,MAAM,IAAA,sIAAW,EAAC;QACnC,OAAO,SAAS,KAAK,IAAI;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO;IACT;AACF"}},
    {"offset": {"line": 460, "column": 0}, "map": {"version":3,"sources":["file:///Users/weili/work/generate-web/services/paymentService.ts"],"sourcesContent":["import { PaymentMethod, CreateOrderRequest, CreateOrderResponse, PaymentOrder } from '../types';\n\n// é…ç½®ï¼šåç«¯ API åœ°å€\n// è¯·æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹ä¸ºä½ çš„åç«¯ API åœ°å€\n// Next.js ç¯å¢ƒå˜é‡éœ€è¦ä»¥ NEXT_PUBLIC_ å¼€å¤´æ‰èƒ½åœ¨å®¢æˆ·ç«¯è®¿é—®\nconst PAYMENT_API_BASE_URL = process.env.NEXT_PUBLIC_PAYMENT_API_URL || 'https://your-api-domain.com/api/payment';\n\n/**\n * åˆ›å»ºæ”¯ä»˜è®¢å•\n * @param request è®¢å•è¯·æ±‚å‚æ•°\n * @returns æ”¯ä»˜å‚æ•°ï¼ˆç”¨äºè°ƒèµ·æ”¯ä»˜ï¼‰\n */\nexport const createPaymentOrder = async (\n  request: CreateOrderRequest\n): Promise<CreateOrderResponse> => {\n  try {\n    const response = await fetch(`${PAYMENT_API_BASE_URL}/create`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(request),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.message || 'åˆ›å»ºè®¢å•å¤±è´¥');\n    }\n\n    const data = await response.json();\n    return data;\n  } catch (error) {\n    console.error('Create payment order error:', error);\n    throw error;\n  }\n};\n\n/**\n * æŸ¥è¯¢è®¢å•çŠ¶æ€\n * @param orderId è®¢å•ID\n * @returns è®¢å•ä¿¡æ¯\n */\nexport const queryOrderStatus = async (orderId: string): Promise<PaymentOrder> => {\n  try {\n    const response = await fetch(`${PAYMENT_API_BASE_URL}/query/${orderId}`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error('æŸ¥è¯¢è®¢å•å¤±è´¥');\n    }\n\n    const data = await response.json();\n    return data;\n  } catch (error) {\n    console.error('Query order status error:', error);\n    throw error;\n  }\n};\n\n/**\n * è°ƒèµ·å¾®ä¿¡æ”¯ä»˜\n * @param params å¾®ä¿¡æ”¯ä»˜å‚æ•°\n * @returns Promise<void>\n */\nexport const launchWechatPay = (params: {\n  appId: string;\n  timeStamp: string;\n  nonceStr: string;\n  package: string;\n  signType: string;\n  paySign: string;\n}): Promise<void> => {\n  return new Promise((resolve, reject) => {\n    // æ£€æŸ¥æ˜¯å¦åœ¨å¾®ä¿¡ç¯å¢ƒ\n    if (typeof window === 'undefined' || !(window as any).WeixinJSBridge) {\n      // å¦‚æœä¸åœ¨å¾®ä¿¡ç¯å¢ƒï¼Œå°è¯•ä½¿ç”¨ JSSDK\n      if ((window as any).wx) {\n        // ä½¿ç”¨å¾®ä¿¡ JSSDK è°ƒèµ·æ”¯ä»˜\n        (window as any).wx.chooseWXPay({\n          timestamp: params.timeStamp,\n          nonceStr: params.nonceStr,\n          package: params.package,\n          signType: params.signType,\n          paySign: params.paySign,\n          success: () => {\n            resolve();\n          },\n          fail: (err: any) => {\n            reject(new Error(err.errMsg || 'æ”¯ä»˜å¤±è´¥'));\n          },\n        });\n      } else {\n        reject(new Error('è¯·åœ¨å¾®ä¿¡ä¸­æ‰“å¼€'));\n      }\n      return;\n    }\n\n    // ä½¿ç”¨ WeixinJSBridge è°ƒèµ·æ”¯ä»˜\n    (window as any).WeixinJSBridge.invoke(\n      'getBrandWCPayRequest',\n      {\n        appId: params.appId,\n        timeStamp: params.timeStamp,\n        nonceStr: params.nonceStr,\n        package: params.package,\n        signType: params.signType,\n        paySign: params.paySign,\n      },\n      (res: any) => {\n        if (res.err_msg === 'get_brand_wcpay_request:ok') {\n          resolve();\n        } else {\n          reject(new Error(res.err_msg || 'æ”¯ä»˜å¤±è´¥'));\n        }\n      }\n    );\n  });\n};\n\n/**\n * è°ƒèµ·æ”¯ä»˜å®æ”¯ä»˜\n * @param orderString æ”¯ä»˜å®è®¢å•å­—ç¬¦ä¸²\n * @returns Promise<void>\n */\nexport const launchAlipay = (orderString: string): Promise<void> => {\n  return new Promise((resolve, reject) => {\n    // åˆ›å»ºéšè—çš„è¡¨å•å¹¶æäº¤\n    const form = document.createElement('form');\n    form.method = 'POST';\n    form.action = 'https://openapi.alipay.com/gateway.do';\n    form.style.display = 'none';\n\n    // è§£æ orderString å¹¶åˆ›å»ºè¡¨å•å­—æ®µ\n    // orderString æ ¼å¼é€šå¸¸æ˜¯ï¼šapp_id=xxx&biz_content=xxx&charset=xxx&...\n    const params = new URLSearchParams(orderString);\n    params.forEach((value, key) => {\n      const input = document.createElement('input');\n      input.type = 'hidden';\n      input.name = key;\n      input.value = value;\n      form.appendChild(input);\n    });\n\n    document.body.appendChild(form);\n    form.submit();\n\n    // æ³¨æ„ï¼šæ”¯ä»˜å®æ”¯ä»˜åä¼šåœ¨æ–°çª—å£æ‰“å¼€ï¼Œæ— æ³•ç›´æ¥ç›‘å¬ç»“æœ\n    // éœ€è¦é€šè¿‡è½®è¯¢è®¢å•çŠ¶æ€æ¥ç¡®è®¤æ”¯ä»˜ç»“æœ\n    resolve();\n  });\n};\n\n/**\n * è½®è¯¢è®¢å•çŠ¶æ€ç›´åˆ°æ”¯ä»˜å®Œæˆæˆ–è¶…æ—¶\n * @param orderId è®¢å•ID\n * @param maxAttempts æœ€å¤§å°è¯•æ¬¡æ•°\n * @param interval è½®è¯¢é—´éš”ï¼ˆæ¯«ç§’ï¼‰\n * @returns è®¢å•çŠ¶æ€\n */\nexport const pollOrderStatus = async (\n  orderId: string,\n  maxAttempts = 30,\n  interval = 2000\n): Promise<PaymentOrder> => {\n  for (let i = 0; i < maxAttempts; i++) {\n    try {\n      const order = await queryOrderStatus(orderId);\n      if (order.status === 'SUCCESS' || order.status === 'FAILED' || order.status === 'CANCELLED') {\n        return order;\n      }\n      // ç­‰å¾…åç»§ç»­è½®è¯¢\n      await new Promise((resolve) => setTimeout(resolve, interval));\n    } catch (error) {\n      console.error(`Poll attempt ${i + 1} failed:`, error);\n      if (i === maxAttempts - 1) {\n        throw error;\n      }\n      await new Promise((resolve) => setTimeout(resolve, interval));\n    }\n  }\n  throw new Error('æ”¯ä»˜è¶…æ—¶ï¼Œè¯·ç¨åæŸ¥è¯¢è®¢å•çŠ¶æ€');\n};\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 590, "column": 0}, "map": {"version":3,"sources":["file:///Users/weili/work/generate-web/components/PaymentModal.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState } from 'react';\nimport { X, CreditCard, Smartphone, Loader2, CheckCircle, XCircle } from 'lucide-react';\nimport { PaymentMethod, CreateOrderRequest } from '@/types';\nimport { createPaymentOrder, launchWechatPay, launchAlipay, pollOrderStatus } from '@/services/paymentService';\nimport { getUserId } from '@/lib/cookies';\n\ninterface PaymentModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess: () => void;\n  amount: number; // é‡‘é¢ï¼ˆå…ƒï¼‰\n  productName: string;\n  productDesc?: string;\n}\n\nconst PaymentModal: React.FC<PaymentModalProps> = ({\n  isOpen,\n  onClose,\n  onSuccess,\n  amount,\n  productName,\n  productDesc,\n}) => {\n  const [selectedMethod, setSelectedMethod] = useState<PaymentMethod | null>(null);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [paymentStatus, setPaymentStatus] = useState<'idle' | 'processing' | 'success' | 'failed'>('idle');\n\n  if (!isOpen) return null;\n\n  const handlePayment = async () => {\n    if (!selectedMethod) {\n      setError('è¯·é€‰æ‹©æ”¯ä»˜æ–¹å¼');\n      return;\n    }\n\n    setIsProcessing(true);\n    setError(null);\n    setPaymentStatus('processing');\n\n    try {\n      // 1. åˆ›å»ºè®¢å•\n      const request: CreateOrderRequest = {\n        amount: Math.round(amount * 100), // è½¬æ¢ä¸ºåˆ†\n        productName,\n        productDesc,\n        paymentMethod: selectedMethod,\n        userId: getUserId() || undefined, // å¦‚æœæœ‰ç”¨æˆ·ID\n      };\n\n      const orderResponse = await createPaymentOrder(request);\n      const { orderId, paymentParams } = orderResponse;\n\n      // 2. è°ƒèµ·æ”¯ä»˜\n      if (selectedMethod === PaymentMethod.WECHAT) {\n        await launchWechatPay(paymentParams as any);\n      } else if (selectedMethod === PaymentMethod.ALIPAY) {\n        await launchAlipay((paymentParams as any).orderString);\n      }\n\n      // 3. è½®è¯¢è®¢å•çŠ¶æ€\n      const order = await pollOrderStatus(orderId);\n\n      if (order.status === 'SUCCESS') {\n        setPaymentStatus('success');\n        setTimeout(() => {\n          onSuccess();\n          handleClose();\n        }, 1500);\n      } else {\n        setPaymentStatus('failed');\n        setError('æ”¯ä»˜å¤±è´¥ï¼Œè¯·é‡è¯•');\n      }\n    } catch (err: any) {\n      console.error('Payment error:', err);\n      setPaymentStatus('failed');\n      setError(err.message || 'æ”¯ä»˜å¤±è´¥ï¼Œè¯·é‡è¯•');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleClose = () => {\n    if (!isProcessing) {\n      setSelectedMethod(null);\n      setError(null);\n      setPaymentStatus('idle');\n      onClose();\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in duration-200 p-4\">\n      <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-md md:max-w-lg mx-4 overflow-hidden animate-in zoom-in-95 duration-200\">\n        {/* Header */}\n        <div className=\"relative bg-gradient-to-r from-violet-600 to-violet-700 p-6 text-white\">\n          <button\n            onClick={handleClose}\n            disabled={isProcessing}\n            className=\"absolute top-4 right-4 p-2 hover:bg-white/20 rounded-full transition-colors disabled:opacity-50\"\n          >\n            <X size={20} />\n          </button>\n          <h2 className=\"text-2xl font-bold\">å‡çº§ä¼šå‘˜</h2>\n          <p className=\"text-violet-100 text-sm mt-1\">{productDesc || 'è§£é”æ›´å¤šåŠŸèƒ½'}</p>\n        </div>\n\n        {/* Content */}\n        <div className=\"p-6 space-y-6\">\n          {/* Amount Display */}\n          <div className=\"text-center py-4 bg-gray-50 rounded-2xl\">\n            <div className=\"text-sm text-gray-500 mb-1\">æ”¯ä»˜é‡‘é¢</div>\n            <div className=\"text-4xl font-bold text-gray-900\">\n              Â¥<span>{amount.toFixed(2)}</span>\n            </div>\n          </div>\n\n          {/* Payment Methods */}\n          {paymentStatus === 'idle' && (\n            <div className=\"space-y-3\">\n              <div className=\"text-sm font-semibold text-gray-700 mb-2\">é€‰æ‹©æ”¯ä»˜æ–¹å¼</div>\n              \n              <button\n                onClick={() => setSelectedMethod(PaymentMethod.WECHAT)}\n                disabled={isProcessing}\n                className={`w-full p-4 rounded-xl border-2 transition-all flex items-center gap-4 ${\n                  selectedMethod === PaymentMethod.WECHAT\n                    ? 'border-violet-500 bg-violet-50'\n                    : 'border-gray-200 hover:border-violet-200'\n                } ${isProcessing ? 'opacity-50 cursor-not-allowed' : ''}`}\n              >\n                <div className={`w-12 h-12 rounded-lg flex items-center justify-center ${\n                  selectedMethod === PaymentMethod.WECHAT ? 'bg-violet-100' : 'bg-gray-100'\n                }`}>\n                  <Smartphone size={24} className={selectedMethod === PaymentMethod.WECHAT ? 'text-violet-600' : 'text-gray-600'} />\n                </div>\n                <div className=\"flex-1 text-left\">\n                  <div className=\"font-semibold text-gray-900\">å¾®ä¿¡æ”¯ä»˜</div>\n                  <div className=\"text-xs text-gray-500\">æ¨èä½¿ç”¨</div>\n                </div>\n                {selectedMethod === PaymentMethod.WECHAT && (\n                  <div className=\"w-5 h-5 rounded-full bg-violet-600 flex items-center justify-center\">\n                    <div className=\"w-2 h-2 rounded-full bg-white\"></div>\n                  </div>\n                )}\n              </button>\n\n              <button\n                onClick={() => setSelectedMethod(PaymentMethod.ALIPAY)}\n                disabled={isProcessing}\n                className={`w-full p-4 rounded-xl border-2 transition-all flex items-center gap-4 ${\n                  selectedMethod === PaymentMethod.ALIPAY\n                    ? 'border-violet-500 bg-violet-50'\n                    : 'border-gray-200 hover:border-violet-200'\n                } ${isProcessing ? 'opacity-50 cursor-not-allowed' : ''}`}\n              >\n                <div className={`w-12 h-12 rounded-lg flex items-center justify-center ${\n                  selectedMethod === PaymentMethod.ALIPAY ? 'bg-violet-100' : 'bg-gray-100'\n                }`}>\n                  <CreditCard size={24} className={selectedMethod === PaymentMethod.ALIPAY ? 'text-violet-600' : 'text-gray-600'} />\n                </div>\n                <div className=\"flex-1 text-left\">\n                  <div className=\"font-semibold text-gray-900\">æ”¯ä»˜å®</div>\n                  <div className=\"text-xs text-gray-500\">å®‰å…¨ä¾¿æ·</div>\n                </div>\n                {selectedMethod === PaymentMethod.ALIPAY && (\n                  <div className=\"w-5 h-5 rounded-full bg-violet-600 flex items-center justify-center\">\n                    <div className=\"w-2 h-2 rounded-full bg-white\"></div>\n                  </div>\n                )}\n              </button>\n            </div>\n          )}\n\n          {/* Processing Status */}\n          {paymentStatus === 'processing' && (\n            <div className=\"flex flex-col items-center justify-center py-8 space-y-4\">\n              <Loader2 className=\"w-12 h-12 text-violet-600 animate-spin\" />\n              <div className=\"text-center\">\n                <div className=\"font-semibold text-gray-900\">æ­£åœ¨å¤„ç†æ”¯ä»˜...</div>\n                <div className=\"text-sm text-gray-500 mt-1\">è¯·å®Œæˆæ”¯ä»˜æ“ä½œ</div>\n              </div>\n            </div>\n          )}\n\n          {/* Success Status */}\n          {paymentStatus === 'success' && (\n            <div className=\"flex flex-col items-center justify-center py-8 space-y-4\">\n              <CheckCircle className=\"w-16 h-16 text-green-500\" />\n              <div className=\"text-center\">\n                <div className=\"font-semibold text-gray-900 text-lg\">æ”¯ä»˜æˆåŠŸï¼</div>\n                <div className=\"text-sm text-gray-500 mt-1\">æ­£åœ¨ä¸ºæ‚¨å‡çº§ä¼šå‘˜...</div>\n              </div>\n            </div>\n          )}\n\n          {/* Failed Status */}\n          {paymentStatus === 'failed' && (\n            <div className=\"flex flex-col items-center justify-center py-8 space-y-4\">\n              <XCircle className=\"w-16 h-16 text-red-500\" />\n              <div className=\"text-center\">\n                <div className=\"font-semibold text-gray-900 text-lg\">æ”¯ä»˜å¤±è´¥</div>\n                <div className=\"text-sm text-gray-500 mt-1\">{error || 'è¯·é‡è¯•'}</div>\n              </div>\n            </div>\n          )}\n\n          {/* Error Message */}\n          {error && paymentStatus === 'idle' && (\n            <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl text-sm\">\n              {error}\n            </div>\n          )}\n\n          {/* Action Buttons */}\n          {paymentStatus === 'idle' && (\n            <button\n              onClick={handlePayment}\n              disabled={!selectedMethod || isProcessing}\n              className={`w-full py-4 rounded-xl font-semibold text-white transition-all flex items-center justify-center gap-2 ${\n                !selectedMethod || isProcessing\n                  ? 'bg-gray-300 cursor-not-allowed'\n                  : 'bg-violet-600 hover:bg-violet-700 active:scale-95'\n              }`}\n            >\n              {isProcessing ? (\n                <>\n                  <Loader2 className=\"animate-spin\" size={18} />\n                  å¤„ç†ä¸­...\n                </>\n              ) : (\n                <>\n                  <CreditCard size={18} />\n                  ç¡®è®¤æ”¯ä»˜ Â¥{amount.toFixed(2)}\n                </>\n              )}\n            </button>\n          )}\n\n          {paymentStatus === 'failed' && (\n            <div className=\"flex gap-3\">\n              <button\n                onClick={handleClose}\n                className=\"flex-1 py-3 rounded-xl font-semibold border-2 border-gray-200 text-gray-700 hover:bg-gray-50\"\n              >\n                å–æ¶ˆ\n              </button>\n              <button\n                onClick={() => {\n                  setPaymentStatus('idle');\n                  setError(null);\n                }}\n                className=\"flex-1 py-3 rounded-xl font-semibold bg-violet-600 text-white hover:bg-violet-700\"\n              >\n                é‡è¯•\n              </button>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default PaymentModal;\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1119, "column": 0}, "map": {"version":3,"sources":["file:///Users/weili/work/generate-web/app/profile/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useRouter } from \"next/navigation\";\nimport {\n  Clock,\n  ImageIcon,\n  Crown,\n  Zap,\n  LogOut,\n  Check,\n  Square,\n  Trash2,\n  X,\n  Download,\n  Smile,\n} from \"lucide-react\";\nimport { useAppSelector, useAppDispatch } from \"@/store/hooks\";\nimport {\n  setIsSelectionMode,\n  setSelectedHistoryIds,\n  toggleHistorySelection,\n  setViewingHistoryItem,\n  setIsPaymentModalOpen,\n} from \"@/store/slices/appSlice\";\nimport { removeFromHistory, setHistory } from \"@/store/slices/imageSlice\";\nimport { deleteHistory } from \"@/services/historyService\";\nimport { setUserTier, clearUserInfo } from \"@/store/slices/userSlice\";\nimport { logout } from \"@/services/authService\";\nimport { UserTier } from \"@/types\";\nimport { setMemeDrafts, setActiveDraftIndex } from \"@/store/slices/memeSlice\";\nimport { AnimationType } from \"@/types\";\nimport PaymentModal from \"@/components/PaymentModal\";\n\nconst FREE_DAILY_LIMIT = 5;\nconst PREMIUM_DAILY_LIMIT = 50;\n\nexport default function ProfilePage() {\n  const router = useRouter();\n  const dispatch = useAppDispatch();\n  const userStatus = useAppSelector((state) => state.user.status);\n  const userId = useAppSelector((state) => state.user.userId);\n  const phone = useAppSelector((state) => state.user.phone);\n  const isPremium = useAppSelector(\n    (state) => state.user.userTier === UserTier.PREMIUM\n  );\n  const sceneUsage = useAppSelector((state) => state.user.sceneUsage);\n  const memeUsage = useAppSelector((state) => state.user.memeUsage);\n  const history = useAppSelector((state) => state.image.history);\n  const isSelectionMode = useAppSelector((state) => state.app.isSelectionMode);\n  const selectedHistoryIds = useAppSelector(\n    (state) => state.app.selectedHistoryIds\n  );\n  const viewingHistoryItemId = useAppSelector(\n    (state) => state.app.viewingHistoryItem\n  );\n  const isPaymentModalOpen = useAppSelector(\n    (state) => state.app.isPaymentModalOpen\n  );\n\n  const GUEST_DAILY_LIMIT = 1; // æ¸¸å®¢1æ¬¡\n  const limit = isPremium\n    ? PREMIUM_DAILY_LIMIT\n    : userStatus === \"LOGGED_IN\"\n    ? FREE_DAILY_LIMIT\n    : GUEST_DAILY_LIMIT;\n\n  // ç›´æ¥ä½¿ç”¨åç«¯è¿”å›çš„ countï¼ˆåç«¯å·²å¤„ç†æ—¥æœŸåˆ¤æ–­å’Œé‡ç½®ï¼‰\n  const sceneUsed = sceneUsage.count || 0;\n  const memeUsed = memeUsage.count || 0;\n  const sceneRemaining = Math.max(0, limit - sceneUsed);\n  const memeRemaining = Math.max(0, limit - memeUsed);\n  const scenePercentage = Math.min(100, (sceneUsed / limit) * 100);\n  const memePercentage = Math.min(100, (memeUsed / limit) * 100);\n  const viewingHistoryItem = viewingHistoryItemId\n    ? history.find((item) => item.id === viewingHistoryItemId)\n    : null;\n\n  // å†å²è®°å½•å·²åœ¨ SSR ä¾§åŠ è½½ï¼Œä¸å†éœ€è¦å®¢æˆ·ç«¯åŠ è½½\n  // å¦‚æœéœ€è¦åˆ·æ–°å†å²è®°å½•ï¼Œå¯ä»¥åœ¨è¿™é‡Œæ·»åŠ åˆ·æ–°é€»è¾‘\n\n  const startBatchMemeCreation = () => {\n    const selectedItems = history.filter((h) =>\n      selectedHistoryIds.includes(h.id)\n    );\n    if (selectedItems.length === 0) return;\n\n    const drafts = selectedItems.map((item) => ({\n      id: Date.now() + Math.random().toString(),\n      sourceUrl: item.url,\n      generatedUrl: null,\n      text: \"é…æ–‡\",\n      moodPrompt: \"å¯çˆ±çš„è¡¨æƒ…\",\n      status: \"pending\" as const,\n      animation: AnimationType.NONE,\n    }));\n\n    dispatch(setMemeDrafts(drafts));\n    dispatch(setActiveDraftIndex(0));\n    dispatch(setIsSelectionMode(false));\n    dispatch(setSelectedHistoryIds([]));\n    router.push(\"/meme-editor\");\n  };\n\n  return (\n    <div\n      className=\"min-h-screen bg-gray-50\"\n      style={{ backgroundColor: \"#f9fafb\" }}\n    >\n      <div\n        className=\"flex flex-col min-h-screen bg-gray-50 pb-24 md:pt-16\"\n        style={{ backgroundColor: \"#f9fafb\" }}\n      >\n        <header className=\"bg-white p-4 md:hidden sticky top-0 z-10 shadow-sm border-b border-gray-100 flex items-center justify-center\">\n          <h2 className=\"font-bold text-lg text-gray-800\">æˆ‘çš„</h2>\n        </header>\n\n        <div className=\"flex-1 p-4 md:p-8 space-y-6 overflow-y-auto max-w-7xl mx-auto w-full\">\n          {/* User Card */}\n          {!isSelectionMode && (\n            <div\n              className={`relative rounded-3xl p-6 text-white overflow-hidden shadow-lg transition-all duration-500 ${\n                isPremium\n                  ? \"bg-gradient-to-br from-slate-800 to-slate-900 shadow-slate-200\"\n                  : \"bg-gradient-to-br from-violet-500 to-violet-600 shadow-violet-200\"\n              }`}\n            >\n              {isPremium && (\n                <div className=\"absolute -right-8 -top-8 text-white/10\">\n                  <Crown size={120} />\n                </div>\n              )}\n\n              <div className=\"relative z-10 flex items-center justify-between gap-4 mb-6\">\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"w-16 h-16 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center text-2xl font-bold border-2 border-white/30\">\n                    {isPremium ? \"ğŸ’\" : \"ğŸ¨\"}\n                  </div>\n                  <div>\n                    <h3 className=\"font-bold text-xl\">\n                      {isPremium\n                        ? \"å°Šè´µä¼šå‘˜\"\n                        : userStatus === \"LOGGED_IN\"\n                        ? \"æ™®é€šç”¨æˆ·\"\n                        : \"æ¸¸å®¢\"}\n                    </h3>\n                    <p className=\"text-white/80 text-xs flex items-center gap-1 mt-1\">\n                      {userStatus === \"LOGGED_IN\" && phone ? (\n                        <>\n                          ID: {phone}\n                          {isPremium && (\n                            <span className=\"bg-amber-400 text-amber-900 text-[10px] font-bold px-1.5 rounded ml-1\">\n                              PRO\n                            </span>\n                          )}\n                        </>\n                      ) : (\n                        <>\n                          ID: æ¸¸å®¢\n                          {isPremium && (\n                            <span className=\"bg-amber-400 text-amber-900 text-[10px] font-bold px-1.5 rounded ml-1\">\n                              PRO\n                            </span>\n                          )}\n                        </>\n                      )}\n                    </p>\n                  </div>\n                </div>\n                {userStatus === \"LOGGED_IN\" && (\n                  <button\n                    onClick={async () => {\n                      await logout();\n                      dispatch(clearUserInfo());\n                      router.push(\"/\");\n                    }}\n                    className=\"px-4 py-2 rounded-xl font-semibold text-sm flex items-center justify-center gap-2 transition-colors bg-white/10 hover:bg-white/20 text-white border border-white/20 whitespace-nowrap\"\n                  >\n                    <LogOut size={16} /> é€€å‡ºç™»å½•\n                  </button>\n                )}\n              </div>\n\n              <div className=\"relative z-10 space-y-3\">\n                {/* åœºæ™¯æ‰©å±•é¢åº¦ */}\n                <div className=\"bg-black/20 rounded-2xl p-4 backdrop-blur-sm\">\n                  <div className=\"flex justify-between items-end mb-2\">\n                    <span className=\"text-xs text-white/80\">åœºæ™¯æ‰©å±•é¢åº¦</span>\n                    <span className=\"font-mono font-bold text-xl\">\n                      {sceneRemaining}{\" \"}\n                      <span className=\"text-sm text-white/60\">/ {limit}</span>\n                    </span>\n                  </div>\n                  <div className=\"w-full bg-white/20 rounded-full h-2 overflow-hidden\">\n                    <div\n                      className={`h-full rounded-full ${\n                        isPremium ? \"bg-amber-400\" : \"bg-white\"\n                      }`}\n                      style={{ width: `${100 - scenePercentage}%` }}\n                    ></div>\n                  </div>\n                </div>\n\n                {/* è¡¨æƒ…åŒ…åˆ¶ä½œé¢åº¦ */}\n                <div className=\"bg-black/20 rounded-2xl p-4 backdrop-blur-sm\">\n                  <div className=\"flex justify-between items-end mb-2\">\n                    <span className=\"text-xs text-white/80\">\n                      è¡¨æƒ…åŒ…åˆ¶ä½œé¢åº¦\n                    </span>\n                    <span className=\"font-mono font-bold text-xl\">\n                      {memeRemaining}{\" \"}\n                      <span className=\"text-sm text-white/60\">/ {limit}</span>\n                    </span>\n                  </div>\n                  <div className=\"w-full bg-white/20 rounded-full h-2 overflow-hidden\">\n                    <div\n                      className={`h-full rounded-full ${\n                        isPremium ? \"bg-amber-400\" : \"bg-white\"\n                      }`}\n                      style={{ width: `${100 - memePercentage}%` }}\n                    ></div>\n                  </div>\n                </div>\n\n                <p className=\"text-[10px] text-white/60 text-right\">\n                  æ¯æ—¥ 00:00 é‡ç½®\n                </p>\n              </div>\n\n              {/* Action Buttons */}\n              <div className=\"mt-4 space-y-2\">\n                {userStatus === \"GUEST\" && (\n                  <button\n                    onClick={() => router.push(\"/login\")}\n                    className=\"w-full py-2.5 rounded-xl font-semibold text-sm flex items-center justify-center gap-2 transition-colors bg-white/10 hover:bg-white/20 text-white border border-white/20\"\n                  >\n                    <Zap size={16} /> ç™»å½•è·å–æ›´å¤šé¢åº¦\n                  </button>\n                )}\n                {userStatus === \"LOGGED_IN\" && (\n                  <button\n                    onClick={() => {\n                      if (isPremium) {\n                        dispatch(setUserTier(UserTier.FREE));\n                      } else {\n                        dispatch(setIsPaymentModalOpen(true));\n                      }\n                    }}\n                    className={`w-full py-3 md:py-2.5 rounded-xl font-semibold text-sm md:text-sm flex items-center justify-center gap-2 transition-colors ${\n                      isPremium\n                        ? \"bg-white/10 hover:bg-white/20 text-white border border-white/20\"\n                        : \"bg-amber-400 text-amber-900 hover:bg-amber-300 shadow-lg shadow-amber-900/20\"\n                    }`}\n                  >\n                    {isPremium ? (\n                      <>\n                        <Crown size={18} className=\"md:w-4 md:h-4\" />\n                        <span className=\"hidden sm:inline\">\n                          åˆ‡æ¢å›æ™®é€šç‰ˆ (æµ‹è¯•)\n                        </span>\n                        <span className=\"sm:hidden text-base\">åˆ‡æ¢æ™®é€šç‰ˆ</span>\n                      </>\n                    ) : (\n                      <>\n                        <Crown size={18} className=\"md:w-4 md:h-4\" />\n\n                        <span className=\"text-base font-bold\">å‡çº§ä¼šå‘˜</span>\n                      </>\n                    )}\n                  </button>\n                )}\n              </div>\n            </div>\n          )}\n\n          {/* ä¼šå‘˜æƒç›Šè¯´æ˜ */}\n          {!isSelectionMode && (\n            <div className=\"bg-white rounded-3xl p-6 shadow-sm border border-gray-100\">\n              <div className=\"flex items-center gap-2 mb-4\">\n                <Crown size={20} className=\"text-amber-500\" />\n                <h3 className=\"font-bold text-lg text-gray-800\">ä¼šå‘˜æƒç›Š</h3>\n              </div>\n              <div className=\"space-y-4\">\n                {/* ä½¿ç”¨é¢åº¦æƒç›Š */}\n                <div className=\"flex items-start gap-3\">\n                  <div className=\"flex-shrink-0 w-6 h-6 rounded-full bg-amber-100 flex items-center justify-center mt-0.5\">\n                    <Check size={14} className=\"text-amber-600\" />\n                  </div>\n                  <div className=\"flex-1\">\n                    <p className=\"font-semibold text-gray-800 mb-1\">\n                      æ¯æ—¥ä½¿ç”¨é¢åº¦\n                    </p>\n                    <p className=\"text-sm text-gray-600 leading-relaxed\">\n                      <span className=\"font-medium text-amber-600\">50 æ¬¡</span>{\" \"}\n                      åœºæ™¯æ‰©å±• +{\" \"}\n                      <span className=\"font-medium text-amber-600\">50 æ¬¡</span>{\" \"}\n                      è¡¨æƒ…åŒ…åˆ¶ä½œ\n                    </p>\n                    <p className=\"text-xs text-gray-400 mt-1\">\n                      æ™®é€šç”¨æˆ·æ¯æ—¥ä»… 5 æ¬¡é¢åº¦\n                    </p>\n                  </div>\n                </div>\n\n                {/* åˆ†è¾¨ç‡è®¾ç½®æƒç›Š */}\n                <div className=\"flex items-start gap-3\">\n                  <div className=\"flex-shrink-0 w-6 h-6 rounded-full bg-amber-100 flex items-center justify-center mt-0.5\">\n                    <Check size={14} className=\"text-amber-600\" />\n                  </div>\n                  <div className=\"flex-1\">\n                    <p className=\"font-semibold text-gray-800 mb-1\">\n                      åœºæ™¯æ‰©å±•åˆ†è¾¨ç‡è®¾ç½®\n                    </p>\n                    <p className=\"text-sm text-gray-600 leading-relaxed\">\n                      æ”¯æŒè‡ªå®šä¹‰åˆ†è¾¨ç‡è®¾ç½®ï¼Œç”Ÿæˆæ›´é«˜è´¨é‡çš„åœºæ™¯æ‰©å±•å›¾ç‰‡\n                    </p>\n                    <p className=\"text-xs text-gray-400 mt-1\">\n                      æ™®é€šç”¨æˆ·ä½¿ç”¨é»˜è®¤åˆ†è¾¨ç‡\n                    </p>\n                  </div>\n                </div>\n\n                {/* å…¶ä»–æƒç›Šæç¤º */}\n                <div className=\"pt-3 border-t border-gray-100\">\n                  <p className=\"text-xs text-gray-500 text-center\">\n                    æ›´å¤šä¼šå‘˜ä¸“å±åŠŸèƒ½æŒç»­æ›´æ–°ä¸­...\n                  </p>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* History Section */}\n          <div>\n            <div className=\"flex items-center justify-between mb-3 px-1\">\n              <h3 className=\"font-bold text-gray-800 flex items-center gap-2\">\n                <Clock size={18} className=\"text-violet-500\" />\n                {isSelectionMode ? \"è¯·é€‰æ‹©å›¾ç‰‡ (1-9å¼ )\" : \"åˆ›ä½œå†å²\"}\n              </h3>\n              <div className=\"flex items-center gap-3\">\n                {history.length > 0 && !isSelectionMode && (\n                  <span className=\"text-xs text-gray-400\">\n                    æœ€è¿‘ {history.length} æ¡\n                  </span>\n                )}\n                <button\n                  onClick={() => {\n                    if (isSelectionMode) {\n                      dispatch(setIsSelectionMode(false));\n                      dispatch(setSelectedHistoryIds([]));\n                    } else {\n                      dispatch(setIsSelectionMode(true));\n                    }\n                  }}\n                  className={`text-sm font-medium px-4 py-2 rounded-lg transition-colors ${\n                    isSelectionMode\n                      ? \"text-violet-600 bg-violet-50 border border-violet-200\"\n                      : \"text-gray-600 hover:bg-gray-50 border border-gray-200\"\n                  }`}\n                >\n                  {isSelectionMode ? \"å–æ¶ˆ\" : \"å¤šé€‰\"}\n                </button>\n              </div>\n            </div>\n\n            {history.length === 0 ? (\n              <div className=\"bg-white rounded-2xl p-8 border border-gray-100 flex flex-col items-center justify-center text-gray-400 space-y-4\">\n                <div className=\"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center\">\n                  <ImageIcon size={24} className=\"text-gray-300\" />\n                </div>\n                <p className=\"text-sm\">æš‚æ— ä½œå“ï¼Œå»åˆ›ä½œä½ çš„ç¬¬ä¸€å¼ ç”»å§ï¼</p>\n                <button\n                  onClick={() => router.push(\"/create\")}\n                  className=\"text-violet-600 text-sm font-semibold hover:underline\"\n                >\n                  ç«‹å³åˆ›ä½œ\n                </button>\n              </div>\n            ) : (\n              <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6 pb-20\">\n                {history.map((item) => (\n                  <div\n                    key={item.id}\n                    onClick={() => {\n                      if (isSelectionMode) {\n                        dispatch(toggleHistorySelection(item.id));\n                      } else {\n                        dispatch(setViewingHistoryItem(item.id));\n                      }\n                    }}\n                    className={`\n                      bg-white rounded-2xl overflow-hidden shadow-sm border flex flex-col transition-all cursor-pointer group relative\n                      ${\n                        isSelectionMode && selectedHistoryIds.includes(item.id)\n                          ? \"border-violet-500 ring-2 ring-violet-200\"\n                          : \"border-gray-100\"\n                      }\n                    `}\n                  >\n                    <div className=\"relative aspect-square bg-gray-100 overflow-hidden\">\n                      <img\n                        src={item.url}\n                        alt=\"History\"\n                        className=\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500\"\n                      />\n                      {isSelectionMode && (\n                        <div className=\"absolute top-2 right-2\">\n                          {selectedHistoryIds.includes(item.id) ? (\n                            <div className=\"bg-violet-600 text-white rounded-full p-1 shadow-md\">\n                              <Check size={16} />\n                            </div>\n                          ) : (\n                            <div className=\"bg-white/80 rounded-full p-1 shadow-sm\">\n                              <Square size={16} className=\"text-gray-400\" />\n                            </div>\n                          )}\n                        </div>\n                      )}\n                    </div>\n                    <div className=\"p-3\">\n                      <p className=\"text-xs text-gray-800 font-medium line-clamp-2 mb-1\">\n                        {item.prompt}\n                      </p>\n                      <div className=\"flex items-center justify-between text-[10px] text-gray-400\">\n                        <span>\n                          {new Date(item.timestamp).toLocaleDateString(\n                            undefined,\n                            { month: \"numeric\", day: \"numeric\" }\n                          )}\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Batch Action Bar */}\n        {isSelectionMode && selectedHistoryIds.length > 0 && (\n          <div className=\"fixed bottom-20 left-4 right-4 md:left-auto md:right-auto md:max-w-2xl md:w-full md:mx-auto bg-white rounded-2xl shadow-xl shadow-violet-900/10 p-4 border border-violet-100 flex items-center justify-between z-50 animate-in slide-in-from-bottom-4\">\n            <div className=\"text-sm font-medium text-gray-600\">\n              å·²é€‰{\" \"}\n              <span className=\"text-violet-600 font-bold\">\n                {selectedHistoryIds.length}\n              </span>{\" \"}\n              å¼ \n            </div>\n            <button\n              onClick={startBatchMemeCreation}\n              className=\"bg-violet-600 text-white px-6 py-2 rounded-xl text-sm font-bold shadow-lg shadow-violet-200 hover:bg-violet-700 transition-colors flex items-center gap-2\"\n            >\n              <Smile size={16} /> åˆ¶ä½œè¡¨æƒ…åŒ…\n            </button>\n          </div>\n        )}\n\n        {/* Full Screen History Viewer Modal */}\n        {viewingHistoryItem && (\n          <div className=\"fixed inset-0 z-[60] flex items-center justify-center bg-black/95 backdrop-blur-sm p-4 animate-in fade-in duration-200\">\n            <button\n              onClick={() => dispatch(setViewingHistoryItem(null))}\n              className=\"absolute top-4 right-4 p-2 text-white/70 hover:text-white hover:bg-white/10 rounded-full transition-colors\"\n            >\n              <X size={24} />\n            </button>\n\n            <div className=\"w-full max-w-lg md:max-w-4xl flex flex-col gap-6\">\n              <img\n                src={viewingHistoryItem.url}\n                className=\"w-full h-auto max-h-[60vh] md:max-h-[80vh] object-contain rounded-lg shadow-2xl shadow-violet-900/20\"\n              />\n\n              <div className=\"space-y-4 px-2\">\n                <div className=\"text-white/80 space-y-1\">\n                  <p className=\"text-xs text-white/40\">æç¤ºè¯</p>\n                  <p className=\"text-sm font-medium\">\n                    {viewingHistoryItem.prompt}\n                  </p>\n                </div>\n\n                <div className=\"flex gap-3\">\n                  <a\n                    href={viewingHistoryItem.url}\n                    download={`history-${viewingHistoryItem.id}.png`}\n                    className=\"flex-1 bg-white text-gray-900 py-3 rounded-xl font-bold text-sm flex items-center justify-center gap-2\"\n                  >\n                    <Download size={16} /> ä¿å­˜\n                  </a>\n                  <button\n                    onClick={async () => {\n                      // ä»æ•°æ®åº“åˆ é™¤\n                      if (userStatus === \"LOGGED_IN\" && userId) {\n                        const success = await deleteHistory(\n                          viewingHistoryItem.id\n                        );\n                        if (success) {\n                          dispatch(removeFromHistory(viewingHistoryItem.id));\n                        }\n                      } else {\n                        dispatch(removeFromHistory(viewingHistoryItem.id));\n                      }\n                      dispatch(setViewingHistoryItem(null));\n                    }}\n                    className=\"flex-none bg-red-500/10 text-red-400 border border-red-500/20 py-3 px-4 rounded-xl flex items-center justify-center hover:bg-red-500/20 transition-colors\"\n                  >\n                    <Trash2 size={18} />\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Payment Modal */}\n      <PaymentModal\n        isOpen={isPaymentModalOpen}\n        onClose={() => dispatch(setIsPaymentModalOpen(false))}\n        onSuccess={() => {\n          dispatch(setUserTier(UserTier.PREMIUM));\n          dispatch(setIsPaymentModalOpen(false));\n        }}\n        amount={29.9}\n        productName=\"IP åˆ›æƒ³åŠä¼šå‘˜\"\n        productDesc=\"è§£é”æ¯æ—¥ 50 æ¬¡ç”Ÿæˆé¢åº¦\"\n      />\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}
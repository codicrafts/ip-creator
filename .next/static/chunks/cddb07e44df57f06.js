(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,68928,8139,e=>{"use strict";var s=e.i(57475);let t=(0,s.default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);e.s(["ImageIcon",()=>t],68928);let l=(0,s.default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>l],8139)},98844,e=>{"use strict";let s=(0,e.i(57475).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>s],98844)},75919,e=>{"use strict";let s=(0,e.i(57475).default)("smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);e.s(["Smile",()=>s],75919)},82285,e=>{"use strict";let s=(0,e.i(57475).default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);e.s(["Download",()=>s],82285)},471,e=>{"use strict";var s=e.i(29336),t=e.i(54558);e.i(82935);let l=async(e,l)=>{try{let r=await (0,s.callCloudFunction)("auth",{action:"login",phone:e,password:l});if(console.log("result",r),1!==r.success)throw Error(r.message||"ç™»å½•å¤±è´¥");let a=r.data;return(0,t.setUserId)(a.userId),{userId:a.userId,phone:a.phone,userTier:a.userTier}}catch(e){throw console.error("Login error:",e),Error(e.message||"ç™»å½•å¤±è´¥")}},r=async()=>{(0,t.clearUserId)(),localStorage.removeItem("ip_creative_scene_usage"),localStorage.removeItem("ip_creative_meme_usage")};e.s(["login",0,l,"logout",0,r])},2153,e=>{"use strict";var s=e.i(1972),t=e.i(30499),l=e.i(57475);let r=(0,l.default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var a=e.i(68928),i=e.i(18486),d=e.i(68163);let n=(0,l.default)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]);var o=e.i(8139),c=e.i(68946);let m=(0,l.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);var x=e.i(83832),h=e.i(82285),u=e.i(75919),p=e.i(24569),g=e.i(93019),b=e.i(8684),f=e.i(24417),j=e.i(11854),y=e.i(471),v=e.i(64807),w=e.i(90816),N=e.i(39382);function k(){let e=(0,t.useRouter)(),l=(0,p.useAppDispatch)(),k=(0,p.useAppSelector)(e=>e.user.status),I=(0,p.useAppSelector)(e=>e.user.userId),M=(0,p.useAppSelector)(e=>e.user.phone),S=(0,p.useAppSelector)(e=>e.user.userTier===v.UserTier.PREMIUM),C=(0,p.useAppSelector)(e=>e.user.sceneUsage),z=(0,p.useAppSelector)(e=>e.user.memeUsage),D=(0,p.useAppSelector)(e=>e.image.history),U=(0,p.useAppSelector)(e=>e.app.isSelectionMode),A=(0,p.useAppSelector)(e=>e.app.selectedHistoryIds),H=(0,p.useAppSelector)(e=>e.app.viewingHistoryItem),O=(0,p.useAppSelector)(e=>e.app.isPaymentModalOpen),E=S?50:"LOGGED_IN"===k?5:1,T=C.count||0,G=z.count||0,P=Math.max(0,E-T),_=Math.max(0,E-G),L=Math.min(100,T/E*100),$=Math.min(100,G/E*100),F=H?D.find(e=>e.id===H):null;return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",style:{backgroundColor:"#f9fafb"},children:[(0,s.jsxs)("div",{className:"flex flex-col min-h-screen bg-gray-50 pb-24 md:pt-16",style:{backgroundColor:"#f9fafb"},children:[(0,s.jsx)("header",{className:"bg-white p-4 md:hidden sticky top-0 z-10 shadow-sm border-b border-gray-100 flex items-center justify-center",children:(0,s.jsx)("h2",{className:"font-bold text-lg text-gray-800",children:"æˆ‘çš„"})}),(0,s.jsxs)("div",{className:"flex-1 p-4 md:p-8 space-y-6 overflow-y-auto max-w-7xl mx-auto w-full",children:[!U&&(0,s.jsxs)("div",{className:`relative rounded-3xl p-6 text-white overflow-hidden shadow-lg transition-all duration-500 ${S?"bg-gradient-to-br from-slate-800 to-slate-900 shadow-slate-200":"bg-gradient-to-br from-violet-500 to-violet-600 shadow-violet-200"}`,children:[S&&(0,s.jsx)("div",{className:"absolute -right-8 -top-8 text-white/10",children:(0,s.jsx)(i.Crown,{size:120})}),(0,s.jsxs)("div",{className:"relative z-10 flex items-center justify-between gap-4 mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"w-16 h-16 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center text-2xl font-bold border-2 border-white/30",children:S?"ðŸ’Ž":"ðŸŽ¨"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-bold text-xl",children:S?"å°Šè´µä¼šå‘˜":"LOGGED_IN"===k?"æ™®é€šç”¨æˆ·":"æ¸¸å®¢"}),(0,s.jsx)("p",{className:"text-white/80 text-xs flex items-center gap-1 mt-1",children:"LOGGED_IN"===k&&M?(0,s.jsxs)(s.Fragment,{children:["ID: ",M,S&&(0,s.jsx)("span",{className:"bg-amber-400 text-amber-900 text-[10px] font-bold px-1.5 rounded ml-1",children:"PRO"})]}):(0,s.jsxs)(s.Fragment,{children:["ID: æ¸¸å®¢",S&&(0,s.jsx)("span",{className:"bg-amber-400 text-amber-900 text-[10px] font-bold px-1.5 rounded ml-1",children:"PRO"})]})})]})]}),"LOGGED_IN"===k&&(0,s.jsxs)("button",{onClick:async()=>{await (0,y.logout)(),l((0,j.clearUserInfo)()),e.push("/")},className:"px-4 py-2 rounded-xl font-semibold text-sm flex items-center justify-center gap-2 transition-colors bg-white/10 hover:bg-white/20 text-white border border-white/20 whitespace-nowrap",children:[(0,s.jsx)(n,{size:16})," é€€å‡ºç™»å½•"]})]}),(0,s.jsxs)("div",{className:"relative z-10 space-y-3",children:[(0,s.jsxs)("div",{className:"bg-black/20 rounded-2xl p-4 backdrop-blur-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between items-end mb-2",children:[(0,s.jsx)("span",{className:"text-xs text-white/80",children:"åœºæ™¯æ‰©å±•é¢åº¦"}),(0,s.jsxs)("span",{className:"font-mono font-bold text-xl",children:[P," ",(0,s.jsxs)("span",{className:"text-sm text-white/60",children:["/ ",E]})]})]}),(0,s.jsx)("div",{className:"w-full bg-white/20 rounded-full h-2 overflow-hidden",children:(0,s.jsx)("div",{className:`h-full rounded-full ${S?"bg-amber-400":"bg-white"}`,style:{width:`${100-L}%`}})})]}),(0,s.jsxs)("div",{className:"bg-black/20 rounded-2xl p-4 backdrop-blur-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between items-end mb-2",children:[(0,s.jsx)("span",{className:"text-xs text-white/80",children:"è¡¨æƒ…åŒ…åˆ¶ä½œé¢åº¦"}),(0,s.jsxs)("span",{className:"font-mono font-bold text-xl",children:[_," ",(0,s.jsxs)("span",{className:"text-sm text-white/60",children:["/ ",E]})]})]}),(0,s.jsx)("div",{className:"w-full bg-white/20 rounded-full h-2 overflow-hidden",children:(0,s.jsx)("div",{className:`h-full rounded-full ${S?"bg-amber-400":"bg-white"}`,style:{width:`${100-$}%`}})})]}),(0,s.jsx)("p",{className:"text-[10px] text-white/60 text-right",children:"æ¯æ—¥ 00:00 é‡ç½®"})]}),(0,s.jsxs)("div",{className:"mt-4 space-y-2",children:["GUEST"===k&&(0,s.jsxs)("button",{onClick:()=>e.push("/login"),className:"w-full py-2.5 rounded-xl font-semibold text-sm flex items-center justify-center gap-2 transition-colors bg-white/10 hover:bg-white/20 text-white border border-white/20",children:[(0,s.jsx)(d.Zap,{size:16})," ç™»å½•èŽ·å–æ›´å¤šé¢åº¦"]}),"LOGGED_IN"===k&&(0,s.jsx)("button",{onClick:()=>{S?l((0,j.setUserTier)(v.UserTier.FREE)):l((0,g.setIsPaymentModalOpen)(!0))},className:`w-full py-3 md:py-2.5 rounded-xl font-semibold text-sm md:text-sm flex items-center justify-center gap-2 transition-colors ${S?"bg-white/10 hover:bg-white/20 text-white border border-white/20":"bg-amber-400 text-amber-900 hover:bg-amber-300 shadow-lg shadow-amber-900/20"}`,children:S?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Crown,{size:18,className:"md:w-4 md:h-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"åˆ‡æ¢å›žæ™®é€šç‰ˆ (æµ‹è¯•)"}),(0,s.jsx)("span",{className:"sm:hidden text-base",children:"åˆ‡æ¢æ™®é€šç‰ˆ"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Crown,{size:18,className:"md:w-4 md:h-4"}),(0,s.jsx)("span",{className:"text-base font-bold",children:"å‡çº§ä¼šå‘˜"})]})})]})]}),!U&&(0,s.jsxs)("div",{className:"bg-white rounded-3xl p-6 shadow-sm border border-gray-100",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,s.jsx)(i.Crown,{size:20,className:"text-amber-500"}),(0,s.jsx)("h3",{className:"font-bold text-lg text-gray-800",children:"ä¼šå‘˜æƒç›Š"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-amber-100 flex items-center justify-center mt-0.5",children:(0,s.jsx)(o.Check,{size:14,className:"text-amber-600"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-semibold text-gray-800 mb-1",children:"æ¯æ—¥ä½¿ç”¨é¢åº¦"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 leading-relaxed",children:[(0,s.jsx)("span",{className:"font-medium text-amber-600",children:"50 æ¬¡"})," ","åœºæ™¯æ‰©å±• +"," ",(0,s.jsx)("span",{className:"font-medium text-amber-600",children:"50 æ¬¡"})," ","è¡¨æƒ…åŒ…åˆ¶ä½œ"]}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"æ™®é€šç”¨æˆ·æ¯æ—¥ä»… 5 æ¬¡é¢åº¦"})]})]}),(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-amber-100 flex items-center justify-center mt-0.5",children:(0,s.jsx)(o.Check,{size:14,className:"text-amber-600"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-semibold text-gray-800 mb-1",children:"åœºæ™¯æ‰©å±•åˆ†è¾¨çŽ‡è®¾ç½®"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 leading-relaxed",children:"æ”¯æŒè‡ªå®šä¹‰åˆ†è¾¨çŽ‡è®¾ç½®ï¼Œç”Ÿæˆæ›´é«˜è´¨é‡çš„åœºæ™¯æ‰©å±•å›¾ç‰‡"}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"æ™®é€šç”¨æˆ·ä½¿ç”¨é»˜è®¤åˆ†è¾¨çŽ‡"})]})]}),(0,s.jsx)("div",{className:"pt-3 border-t border-gray-100",children:(0,s.jsx)("p",{className:"text-xs text-gray-500 text-center",children:"æ›´å¤šä¼šå‘˜ä¸“å±žåŠŸèƒ½æŒç»­æ›´æ–°ä¸­..."})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3 px-1",children:[(0,s.jsxs)("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[(0,s.jsx)(r,{size:18,className:"text-violet-500"}),U?"è¯·é€‰æ‹©å›¾ç‰‡ (1-9å¼ )":"åˆ›ä½œåŽ†å²"]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[D.length>0&&!U&&(0,s.jsxs)("span",{className:"text-xs text-gray-400",children:["æœ€è¿‘ ",D.length," æ¡"]}),(0,s.jsx)("button",{onClick:()=>{U?(l((0,g.setIsSelectionMode)(!1)),l((0,g.setSelectedHistoryIds)([]))):l((0,g.setIsSelectionMode)(!0))},className:`text-sm font-medium px-4 py-2 rounded-lg transition-colors ${U?"text-violet-600 bg-violet-50 border border-violet-200":"text-gray-600 hover:bg-gray-50 border border-gray-200"}`,children:U?"å–æ¶ˆ":"å¤šé€‰"})]})]}),0===D.length?(0,s.jsxs)("div",{className:"bg-white rounded-2xl p-8 border border-gray-100 flex flex-col items-center justify-center text-gray-400 space-y-4",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center",children:(0,s.jsx)(a.ImageIcon,{size:24,className:"text-gray-300"})}),(0,s.jsx)("p",{className:"text-sm",children:"æš‚æ— ä½œå“ï¼ŒåŽ»åˆ›ä½œä½ çš„ç¬¬ä¸€å¼ ç”»å§ï¼"}),(0,s.jsx)("button",{onClick:()=>e.push("/create"),className:"text-violet-600 text-sm font-semibold hover:underline",children:"ç«‹å³åˆ›ä½œ"})]}):(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6 pb-20",children:D.map(e=>(0,s.jsxs)("div",{onClick:()=>{U?l((0,g.toggleHistorySelection)(e.id)):l((0,g.setViewingHistoryItem)(e.id))},className:`
                      bg-white rounded-2xl overflow-hidden shadow-sm border flex flex-col transition-all cursor-pointer group relative
                      ${U&&A.includes(e.id)?"border-violet-500 ring-2 ring-violet-200":"border-gray-100"}
                    `,children:[(0,s.jsxs)("div",{className:"relative aspect-square bg-gray-100 overflow-hidden",children:[(0,s.jsx)("img",{src:e.url,alt:"History",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}),U&&(0,s.jsx)("div",{className:"absolute top-2 right-2",children:A.includes(e.id)?(0,s.jsx)("div",{className:"bg-violet-600 text-white rounded-full p-1 shadow-md",children:(0,s.jsx)(o.Check,{size:16})}):(0,s.jsx)("div",{className:"bg-white/80 rounded-full p-1 shadow-sm",children:(0,s.jsx)(c.Square,{size:16,className:"text-gray-400"})})})]}),(0,s.jsxs)("div",{className:"p-3",children:[(0,s.jsx)("p",{className:"text-xs text-gray-800 font-medium line-clamp-2 mb-1",children:e.prompt}),(0,s.jsx)("div",{className:"flex items-center justify-between text-[10px] text-gray-400",children:(0,s.jsx)("span",{children:new Date(e.timestamp).toLocaleDateString(void 0,{month:"numeric",day:"numeric"})})})]})]},e.id))})]})]}),U&&A.length>0&&(0,s.jsxs)("div",{className:"fixed bottom-20 left-4 right-4 md:left-auto md:right-auto md:max-w-2xl md:w-full md:mx-auto bg-white rounded-2xl shadow-xl shadow-violet-900/10 p-4 border border-violet-100 flex items-center justify-between z-50 animate-in slide-in-from-bottom-4",children:[(0,s.jsxs)("div",{className:"text-sm font-medium text-gray-600",children:["å·²é€‰"," ",(0,s.jsx)("span",{className:"text-violet-600 font-bold",children:A.length})," ","å¼ "]}),(0,s.jsxs)("button",{onClick:()=>{let s=D.filter(e=>A.includes(e.id));if(0===s.length)return;let t=s.map(e=>({id:Date.now()+Math.random().toString(),sourceUrl:e.url,generatedUrl:null,text:"é…æ–‡",moodPrompt:"å¯çˆ±çš„è¡¨æƒ…",status:"pending",animation:v.AnimationType.NONE}));l((0,w.setMemeDrafts)(t)),l((0,w.setActiveDraftIndex)(0)),l((0,g.setIsSelectionMode)(!1)),l((0,g.setSelectedHistoryIds)([])),e.push("/meme-editor")},className:"bg-violet-600 text-white px-6 py-2 rounded-xl text-sm font-bold shadow-lg shadow-violet-200 hover:bg-violet-700 transition-colors flex items-center gap-2",children:[(0,s.jsx)(u.Smile,{size:16})," åˆ¶ä½œè¡¨æƒ…åŒ…"]})]}),F&&(0,s.jsxs)("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/95 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:[(0,s.jsx)("button",{onClick:()=>l((0,g.setViewingHistoryItem)(null)),className:"absolute top-4 right-4 p-2 text-white/70 hover:text-white hover:bg-white/10 rounded-full transition-colors",children:(0,s.jsx)(x.X,{size:24})}),(0,s.jsxs)("div",{className:"w-full max-w-lg md:max-w-4xl flex flex-col gap-6",children:[(0,s.jsx)("img",{src:F.url,className:"w-full h-auto max-h-[60vh] md:max-h-[80vh] object-contain rounded-lg shadow-2xl shadow-violet-900/20"}),(0,s.jsxs)("div",{className:"space-y-4 px-2",children:[(0,s.jsxs)("div",{className:"text-white/80 space-y-1",children:[(0,s.jsx)("p",{className:"text-xs text-white/40",children:"æç¤ºè¯"}),(0,s.jsx)("p",{className:"text-sm font-medium",children:F.prompt})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)("a",{href:F.url,download:`history-${F.id}.png`,className:"flex-1 bg-white text-gray-900 py-3 rounded-xl font-bold text-sm flex items-center justify-center gap-2",children:[(0,s.jsx)(h.Download,{size:16})," ä¿å­˜"]}),(0,s.jsx)("button",{onClick:async()=>{"LOGGED_IN"===k&&I?await (0,f.deleteHistory)(F.id)&&l((0,b.removeFromHistory)(F.id)):l((0,b.removeFromHistory)(F.id)),l((0,g.setViewingHistoryItem)(null))},className:"flex-none bg-red-500/10 text-red-400 border border-red-500/20 py-3 px-4 rounded-xl flex items-center justify-center hover:bg-red-500/20 transition-colors",children:(0,s.jsx)(m,{size:18})})]})]})]})]})]}),(0,s.jsx)(N.default,{isOpen:O,onClose:()=>l((0,g.setIsPaymentModalOpen)(!1)),onSuccess:()=>{l((0,j.setUserTier)(v.UserTier.PREMIUM)),l((0,g.setIsPaymentModalOpen)(!1))},amount:29.9,productName:"IP åˆ›æƒ³åŠä¼šå‘˜",productDesc:"è§£é”æ¯æ—¥ 50 æ¬¡ç”Ÿæˆé¢åº¦"})]})}e.s(["default",()=>k],2153)},39761,e=>{e.v(e=>Promise.resolve().then(()=>e(54558)))}]);